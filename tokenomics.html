<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tokenomics App | TeamTowers Hum√†. Dise√±a modelos token√≥micos con distribuci√≥n transparente y proyecciones de evoluci√≥n para tu proyecto de La Masia.">
    <meta name="keywords" content="Tokenomics, blockchain, smart contracts, TeamTowers Hum√†, Vilafranca del Pened√®s, tokenizaci√≥n, stakeholders">
    <meta name="author" content="TeamTowers Hum√†">
    <meta name="robots" content="index, follow">
    <title>Tokenomics App | TeamTowers Hum√†</title>
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Tokenomics App | TeamTowers Hum√†">
    <meta property="og:description" content="Dise√±a modelos token√≥micos con distribuci√≥n transparente y proyecciones de evoluci√≥n para tu proyecto de La Masia.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://teamtowershuma.com/tokenomics">
    <meta property="og:image" content="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png">
    <meta property="og:locale" content="es_ES">
    <meta property="og:locale:alternate" content="ca_ES">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Tokenomics App | TeamTowers Hum√†">
    <meta name="twitter:description" content="Modelos token√≥micos transparentes para proyectos de La Masia">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png">
    
    <!-- Chart.js for data visualization - Cargado de forma as√≠ncrona con fallback -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js" defer></script>
    
    <style>
        :root {
            --primary: #1e3a8a; /* Azul TeamTowers */
            --secondary: #4f46e5; /* Azul m√°s claro */
            --accent: #8b5cf6; /* Morado TeamTowers */
            --dark: #0f172a;
            --light: #f8fafc;
            --gold: #f59e01;
            --success: #10b981;
            --warning: #fbbf24;
            --danger: #ef4444;
            --gray: #64748b;
            --border-radius: 12px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fff;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Language Selector */
        .language-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50px;
            padding: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 5px;
        }
        
        .lang-btn {
            padding: 8px 16px;
            border: none;
            background: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-family: inherit;
        }
        
        .lang-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 10px rgba(30, 58, 138, 0.3);
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, var(--dark) 0%, #1e293b 100%);
            color: white;
            padding: 20px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 10;
        }
        
        .header-logo {
            height: 60px;
            margin-bottom: 15px;
            filter: drop-shadow(0 4px 10px rgba(0,0,0,0.3));
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        
        .tagline {
            font-size: 1.4rem;
            opacity: 0.9;
            margin-bottom: 15px;
            font-weight: 300;
        }
        
        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .app-container {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            height: fit-content;
            position: relative;
            z-index: 10;
        }
        
        .panel h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .panel h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 24px;
            background: var(--accent);
            border-radius: 4px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
        }
        
        .input-group label::before {
            content: '‚Ä¢';
            color: var(--accent);
            font-size: 24px;
            line-height: 1;
        }
        
        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        
        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.2);
        }
        
        .input-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.6s;
        }
        
        .btn:hover::after {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #0da27f 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #b91c1c 100%);
            color: white;
        }
        
        .btn-export {
            background: linear-gradient(135deg, #7e3af2 0%, #4f46e5 100%);
            color: white;
            grid-column: span 2;
        }
        
        .visualization-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            position: relative;
            z-index: 10;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
            background: var(--light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chart-placeholder {
            text-align: center;
            color: var(--gray);
            padding: 20px;
        }
        
        .chart-placeholder svg {
            width: 80px;
            height: 80px;
            margin-bottom: 15px;
            color: var(--accent);
            opacity: 0.7;
        }
        
        .chart-placeholder h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .timeline-container {
            position: relative;
            height: 300px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .stakeholder-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stakeholder-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            border-left: 4px solid var(--accent);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }
        
        .stakeholder-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent);
            transform: scaleY(0);
            transform-origin: bottom;
            transition: transform 0.3s ease;
        }
        
        .stakeholder-card:hover::before {
            transform: scaleY(1);
        }
        
        .stakeholder-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stakeholder-card h4 {
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .stakeholder-card h4::before {
            content: 'üë§';
        }
        
        .stakeholder-card .percentage {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
            display: block;
        }
        
        .stakeholder-card .tokens {
            font-size: 1.1rem;
            color: var(--gray);
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .role-tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 5px;
            margin-top: 8px;
        }
        
        .role-team {
            background: rgba(16, 185, 129, 0.15);
            color: #0d9488;
        }
        
        .role-client {
            background: rgba(30, 58, 138, 0.15);
            color: #1e3a8a;
        }
        
        .role-supplier {
            background: rgba(139, 92, 246, 0.15);
            color: #7e3af2;
        }
        
        .role-investor {
            background: rgba(245, 158, 11, 0.15);
            color: #b45309;
        }
        
        .vesting-badge {
            background: rgba(79, 70, 229, 0.15);
            color: #4f46e5;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(135deg, var(--light) 0%, #e0e7ff 100%);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(30, 58, 138, 0.1);
        }
        
        .stat-item {
            text-align: center;
            min-width: 100px;
            padding: 8px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 3px;
        }
        
        .integration-section {
            background: linear-gradient(135deg, var(--light) 0%, #eef2ff 100%);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--accent);
        }
        
        .integration-section h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .integration-section h3::before {
            content: 'üîó';
            font-size: 1.4rem;
        }
        
        .integration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .integration-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border-top: 3px solid var(--primary);
            transition: var(--transition);
        }
        
        .integration-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .integration-card img {
            height: 40px;
            margin-bottom: 10px;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.1));
        }
        
        .integration-card h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .integration-card p {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 20px;
            color: var(--gray);
        }
        
        .empty-state svg {
            width: 120px;
            height: 120px;
            margin-bottom: 20px;
            color: var(--accent);
            opacity: 0.7;
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .empty-state p {
            max-width: 500px;
            margin-bottom: 25px;
            line-height: 1.7;
        }
        
        .instructions {
            background: linear-gradient(135deg, var(--light) 0%, #e0e7ff 100%);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--accent);
        }
        
        .instructions h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .instructions h3::before {
            content: '‚ÑπÔ∏è';
            font-size: 1.4rem;
        }
        
        .instructions ol {
            padding-left: 25px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.7;
        }
        
        .instructions code {
            background: rgba(30, 58, 138, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: 600;
        }
        
        .token-creation {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid var(--accent);
        }
        
        .token-creation h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.6rem;
            font-weight: 700;
        }
        
        .distribution-model {
            margin-top: 20px;
        }
        
        .distribution-model label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-family: inherit;
        }
        
        .distribution-slider {
            width: 100%;
            margin: 15px 0;
            height: 8px;
            -webkit-appearance: none;
            background: #e2e8f0;
            border-radius: 4px;
            outline: none;
        }
        
        .distribution-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.3);
        }
        
        .distribution-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.3);
        }
        
        .slider-values {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--gray);
            font-family: inherit;
        }
        
        .phase-item {
            background: var(--light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 3px solid var(--accent);
        }
        
        .phase-item h4 {
            margin-bottom: 8px;
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        .import-section {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid var(--accent);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: var(--border-radius);
        }
        
        .import-section h3 {
            color: var(--gold);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .import-section h3::before {
            content: 'üìä';
            font-size: 1.4rem;
        }
        
        .csv-preview {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .csv-row {
            display: flex;
            padding: 5px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .csv-header {
            font-weight: 700;
            background: var(--light);
        }
        
        .csv-cell {
            flex: 1;
            padding: 0 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .default-example {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid var(--success);
        }
        
        .default-example h4 {
            color: var(--success);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
        }
        
        .default-example h4::before {
            content: 'üí°';
        }
        
        .test-results {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
            background: var(--light);
            display: none;
        }
        
        .test-pass {
            color: var(--success);
            font-weight: bold;
        }
        
        .test-fail {
            color: var(--danger);
            font-weight: bold;
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: rgba(255, 255, 255, 0.85);
            padding: 60px 20px 30px;
            margin-top: 60px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .footer-col h3 {
            color: white;
            font-size: 1.6rem;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 10px;
            font-weight: 700;
        }
        
        .footer-col h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: var(--accent);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 12px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
            display: block;
            padding: 5px 0;
            font-size: 1.05rem;
            font-family: inherit;
        }
        
        .footer-links a:hover {
            color: var(--accent);
            transform: translateX(5px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 40px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.6);
            font-family: inherit;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .tagline {
                font-size: 1.1rem;
            }
            
            .panel {
                padding: 20px;
            }
            
            .chart-container,
            .timeline-container {
                height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .language-selector {
                top: 15px;
                right: 15px;
                padding: 3px;
            }
            
            .header-logo {
                height: 50px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .tagline {
                font-size: 1rem;
            }
            
            .container {
                padding: 20px 15px;
            }
            
            .btn {
                padding: 12px 15px;
                font-size: 0.95rem;
            }
            
            .chart-container,
            .timeline-container {
                height: 250px;
            }
            
            .stakeholder-grid {
                grid-template-columns: 1fr;
            }
            
            .test-results {
                font-size: 0.8rem;
            }
        }
        
        /* Loading indicator */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .btn.loading::after {
            display: none;
        }
        
        .btn.loading span {
            display: none;
        }
        
        .btn.loading::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
            margin-right: 0;
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="language-selector">
        <button class="lang-btn active" data-lang="es">ES</button>
        <button class="lang-btn" data-lang="ca">CA</button>
    </div>
    
    <!-- Header -->
    <header>
        <div class="header-content">
            <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="TeamTowers Hum√†" class="header-logo">
            <h1 class="lang" data-es="Tokenomics App" data-ca="Tokenomics App">Tokenomics App</h1>
            <p class="tagline lang" data-es="Dise√±a modelos token√≥micos transparentes con distribuci√≥n justa y proyecciones de evoluci√≥n para tu proyecto de La Masia" data-ca="Disse√±a models token√≤mics transparents amb distribuci√≥ justa i projeccions d'evoluci√≥ per al teu projecte de La Masia">Dise√±a modelos token√≥micos transparentes con distribuci√≥n justa y proyecciones de evoluci√≥n para tu proyecto de La Masia</p>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="container">
        <div class="app-container">
            <div class="panel">
                <h2 class="lang" data-es="‚öôÔ∏è Configuraci√≥n del Token" data-ca="‚öôÔ∏è Configuraci√≥ del Token">‚öôÔ∏è Configuraci√≥n del Token</h2>
                <div class="input-group">
                    <label class="lang" data-es="Nombre del Token" data-ca="Nom del Token">Nombre del Token</label>
                    <input type="text" id="token-name" placeholder="Ej: MASIA" value="MASIA">
                </div>
                <div class="input-group">
                    <label class="lang" data-es="S√≠mbolo" data-ca="S√≠mbol">S√≠mbolo</label>
                    <input type="text" id="token-symbol" placeholder="Ej: MSA" value="MSA">
                </div>
                <div class="input-group">
                    <label class="lang" data-es="Suministro Total" data-ca="Subministrament Total">Suministro Total</label>
                    <input type="number" id="total-supply" placeholder="1000000" value="1000000" min="1000">
                </div>
                <div class="input-group">
                    <label class="lang" data-es="Model de Distribuci√≥n" data-ca="Model de Distribuci√≥">Model de Distribuci√≥n</label>
                    <select id="distribution-model">
                        <option value="fibonacci" class="lang" data-es="Modelo Fibonacci (diluci√≥n progresiva)" data-ca="Model Fibonacci (diluci√≥ progressiva)">Modelo Fibonacci (diluci√≥n progresiva)</option>
                        <option value="linear" class="lang" data-es="Lineal (diluci√≥n constante)" data-ca="Lineal (diluci√≥ constant)">Lineal (diluci√≥n constante)</option>
                        <option value="custom" class="lang" data-es="Personalizado (definir fases)" data-ca="Personalitzat (definir fases)">Personalizado (definir fases)</option>
                    </select>
                </div>
                
                <div class="panel" style="margin-top: 20px;">
                    <h2 class="lang" data-es="üì• Integraci√≥n con Apps" data-ca="üì• Integraci√≥ amb Apps">üì• Integraci√≥n con Apps</h2>
                    <div class="btn-group">
                        <button id="import-vna" class="btn btn-primary">
                            <span>üìä</span> <span class="lang" data-es="Importar VNA" data-ca="Importar VNA">Importar VNA</span>
                        </button>
                        <button id="import-value-csv" class="btn btn-secondary">
                            <span>üìÑ</span> <span class="lang" data-es="Importar CSV Contabilidad" data-ca="Importar CSV Comptabilitat">Importar CSV Contabilidad</span>
                        </button>
                        <button id="import-coops" class="btn btn-success">
                            <span>üìö</span> <span class="lang" data-es="Importar CoPs" data-ca="Importar CoPs">Importar CoPs</span>
                        </button>
                    </div>
                    
                    <div class="integration-section">
                        <h3 class="lang" data-es="Conexi√≥n con el Sistema Integral" data-ca="Connexi√≥ amb el Sistema Integral">Conexi√≥n con el Sistema Integral</h3>
                        <div class="integration-grid">
                            <div class="integration-card">
                                <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="VNA">
                                <h4 class="lang" data-es="VNA App" data-ca="VNA App">VNA App</h4>
                                <p class="lang" data-es="Mapa de valor" data-ca="Mapa de valor">Mapa de valor</p>
                            </div>
                            <div class="integration-card">
                                <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="Value Accounting">
                                <h4 class="lang" data-es="Contabilidad" data-ca="Comptabilitat">Contabilidad</h4>
                                <p class="lang" data-es="Valor entregables" data-ca="Valor entregables">Valor entregables</p>
                            </div>
                            <div class="integration-card">
                                <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="CoPs">
                                <h4 class="lang" data-es="Comunidades" data-ca="Comunitats">Comunidades</h4>
                                <p class="lang" data-es="Conocimiento" data-ca="Coneixement">Conocimiento</p>
                            </div>
                            <div class="integration-card">
                                <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="La Masia">
                                <h4 class="lang" data-es="La Masia" data-ca="La Masia">La Masia</h4>
                                <p class="lang" data-es="Sistema integral" data-ca="Sistema integral">Sistema integral</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="import-section">
                    <h3 class="lang" data-es="Importar Datos de Contabilidad de Valor" data-ca="Importar Dades de Comptabilitat de Valor">Importar Datos de Contabilidad de Valor</h3>
                    <p class="lang" data-es="Importa el archivo CSV exportado desde la <a href='https://teamtowershuma.com/app_comptabilitat' target='_blank' style='color: var(--primary); font-weight: 600;'>App de Contabilidad de Valor</a> para visualizar la distribuci√≥n real de tokens seg√∫n el valor aportado por cada stakeholder." data-ca="Importa el fitxer CSV exportat des de l'<a href='https://teamtowershuma.com/app_comptabilitat' target='_blank' style='color: var(--primary); font-weight: 600;'>App de Comptabilitat de Valor</a> per visualitzar la distribuci√≥ real de tokens segons el valor aportat per cada stakeholder.">Importa el archivo CSV exportado desde la <a href="https://teamtowershuma.com/app_comptabilitat" target="_blank" style="color: var(--primary); font-weight: 600;">App de Contabilidad de Valor</a> para visualizar la distribuci√≥n real de tokens seg√∫n el valor aportado por cada stakeholder.</p>
                    
                    <div class="input-group">
                        <label class="lang" data-es="Archivo CSV de Contabilidad de Valor" data-ca="Fitxer CSV de Comptabilitat de Valor">Archivo CSV de Contabilidad de Valor</label>
                        <input type="file" id="value-csv-file" accept=".csv">
                    </div>
                    
                    <div class="btn-group">
                        <button id="process-csv" class="btn btn-primary">
                            <span>üîÑ</span> <span class="lang" data-es="Procesar CSV" data-ca="Processar CSV">Procesar CSV</span>
                        </button>
                    </div>
                    
                    <div id="csv-preview" class="csv-preview" style="display: none;">
                        <div class="csv-row csv-header">
                            <div class="csv-cell lang" data-es="Rol" data-ca="Rol">Rol</div>
                            <div class="csv-cell lang" data-es="Entregable" data-ca="Entregable">Entregable</div>
                            <div class="csv-cell lang" data-es="Valor" data-ca="Valor">Valor</div>
                        </div>
                        <!-- CSV data will be inserted here dynamically -->
                    </div>
                    
                    <div class="default-example">
                        <h4 class="lang" data-es="Ejemplo por Defecto" data-ca="Exemple per Defecte">Ejemplo por Defecto</h4>
                        <p class="lang" data-es="La aplicaci√≥n muestra un ejemplo simulado hasta que importes tus datos reales de Contabilidad de Valor. Este ejemplo demuestra c√≥mo se distribuir√≠an los tokens seg√∫n el modelo Fibonacci." data-ca="L'aplicaci√≥ mostra un exemple simulat fins que importis les teves dades reals de Comptabilitat de Valor. Aquest exemple demostra com es distribuirien els tokens segons el model Fibonacci.">La aplicaci√≥n muestra un ejemplo simulado hasta que importes tus datos reales de Contabilidad de Valor. Este ejemplo demuestra c√≥mo se distribuir√≠an los tokens seg√∫n el modelo Fibonacci.</p>
                    </div>
                    
                    <div class="panel" style="margin-top: 20px; background: #f0f9ff; border-left: 4px solid #0ea5e9;">
                        <h3 style="color: #0ea5e9; margin-bottom: 10px;">üß™ Ejecutar Pruebas</h3>
                        <p style="margin-bottom: 15px; font-size: 0.9rem;">Ejecuta pruebas autom√°ticas para verificar que la aplicaci√≥n funcione correctamente en tu navegador.</p>
                        <button id="run-tests" class="btn btn-warning" style="width: 100%;">
                            <span>üî¨</span> <span class="lang" data-es="Ejecutar Pruebas" data-ca="Executar Proves">Ejecutar Pruebas</span>
                        </button>
                        <div id="test-results" class="test-results"></div>
                    </div>
                </div>
                
                <div class="token-creation">
                    <h3 class="lang" data-es="üéØ Distribuci√≥n Inicial" data-ca="üéØ Distribuci√≥ Inicial">üéØ Distribuci√≥n Inicial</h3>
                    <div class="distribution-model">
                        <label class="lang" data-es="Inversores Iniciales" data-ca="Inversors Inicials">Inversores Iniciales</label>
                        <input type="range" id="investors-slider" class="distribution-slider" min="0" max="100" value="40">
                        <div class="slider-values">
                            <span>0%</span>
                            <span id="investors-value">40%</span>
                            <span>100%</span>
                        </div>
                    </div>
                    
                    <div class="distribution-model">
                        <label class="lang" data-es="Equipo Fundador" data-ca="Equip Fundador">Equipo Fundador</label>
                        <input type="range" id="team-slider" class="distribution-slider" min="0" max="100" value="25">
                        <div class="slider-values">
                            <span>0%</span>
                            <span id="team-value">25%</span>
                            <span>100%</span>
                        </div>
                    </div>
                    
                    <div class="distribution-model">
                        <label class="lang" data-es="Reserva del Proyecto" data-ca="Reserva del Projecte">Reserva del Proyecto</label>
                        <input type="range" id="reserve-slider" class="distribution-slider" min="0" max="100" value="20">
                        <div class="slider-values">
                            <span>0%</span>
                            <span id="reserve-value">20%</span>
                            <span>100%</span>
                        </div>
                    </div>
                    
                    <div class="distribution-model">
                        <label class="lang" data-es="Comunidad (Staking)" data-ca="Comunitat (Staking)">Comunidad (Staking)</label>
                        <input type="range" id="community-slider" class="distribution-slider" min="0" max="100" value="15">
                        <div class="slider-values">
                            <span>0%</span>
                            <span id="community-value">15%</span>
                            <span>100%</span>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button id="simulate-tokenomics" class="btn btn-primary">
                            <span>üöÄ</span> <span class="lang" data-es="Simular Tokenomics" data-ca="Simular Tokenomics">Simular Tokenomics</span>
                        </button>
                    </div>
                </div>
                
                <div class="panel" style="margin-top: 20px;">
                    <h2 class="lang" data-es="üíæ Exportar Datos" data-ca="üíæ Exportar Dades">üíæ Exportar Datos</h2>
                    <div class="btn-group">
                        <button id="export-json" class="btn btn-export">
                            <span>üìä</span> <span class="lang" data-es="Exportar JSON" data-ca="Exportar JSON">Exportar JSON</span>
                        </button>
                        <button id="export-smart-contract" class="btn btn-export">
                            <span>üìú</span> <span class="lang" data-es="Generar Smart Contract" data-ca="Generar Smart Contract">Generar Smart Contract</span>
                        </button>
                        <button id="reset-data" class="btn btn-danger">
                            <span>üóëÔ∏è</span> <span class="lang" data-es="Limpiar Datos" data-ca="Netejar Dades">Limpiar Datos</span>
                        </button>
                    </div>
                </div>
                
                <div class="instructions" style="margin-top: 20px;">
                    <h3 class="lang" data-es="Beneficios del Modelo Token√≥mico" data-ca="Beneficis del Model Token√≤mic">Beneficios del Modelo Token√≥mico</h3>
                    <ol>
                        <li class="lang" data-es="<strong>Transparencia total</strong> - Todos los stakeholders ven exactamente c√≥mo se distribuyen los tokens y c√≥mo evolucionar√° su participaci√≥n" data-ca="<strong>Transpar√®ncia total</strong> - Tots els stakeholders veuen exactament com es distribueixen els tokens i com evolucionar√† la seva participaci√≥"><strong>Transparencia total</strong> - Todos los stakeholders ven exactamente c√≥mo se distribuyen los tokens y c√≥mo evolucionar√° su participaci√≥n</li>
                        <li class="lang" data-es="<strong>Aligaci√≥n de incentivos</strong> - Los tokens recompensan a quienes aportan m√°s valor al proyecto seg√∫n la contabilidad de valor" data-ca="<strong>Aliniaci√≥ d'incentius</strong> - Els tokens recompensen a qui aporta m√©s valor al projecte segons la comptabilitat de valor"><strong>Aligaci√≥n de incentivos</strong> - Los tokens recompensan a quienes aportan m√°s valor al proyecto seg√∫n la contabilidad de valor</li>
                        <li class="lang" data-es="<strong>Captaci√≥n de talento</strong> - El modelo Fibonacci permite diluir progresivamente la participaci√≥n inicial para atraer nuevos stakeholders" data-ca="<strong>Captaci√≥ de talent</strong> - El model Fibonacci permet diluir progressivament la participaci√≥ inicial per atreure nous stakeholders"><strong>Captaci√≥n de talento</strong> - El modelo Fibonacci permite diluir progresivamente la participaci√≥n inicial para atraer nuevos stakeholders</li>
                        <li class="lang" data-es="<strong>Gobernanza descentralizada</strong> - Los tokens permiten votar en decisiones estrat√©gicas del proyecto" data-ca="<strong>Governan√ßa descentralitzada</strong> - Els tokens permeten votar en decisions estrat√®giques del projecte"><strong>Gobernanza descentralizada</strong> - Los tokens permiten votar en decisiones estrat√©gicas del proyecto</li>
                    </ol>
                </div>
            </div>
            
            <div class="visualization-container">
                <h2>üìà <span class="lang" data-es="Distribuci√≥n y Evoluci√≥n de Tokens" data-ca="Distribuci√≥ i Evoluci√≥ de Tokens">Distribuci√≥n y Evoluci√≥n de Tokens</span></h2>
                <div class="chart-container">
                    <div class="chart-placeholder" id="token-chart-placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path>
                        </svg>
                        <h3 class="lang" data-es="Cargando gr√°fico..." data-ca="Carregant gr√†fic...">Cargando gr√°fico...</h3>
                        <p class="lang" data-es="El gr√°fico se mostrar√° aqu√≠ una vez que se carguen los datos" data-ca="El gr√†fic es mostrar√† aqu√≠ un cop es carreguin les dades">El gr√°fico se mostrar√° aqu√≠ una vez que se carguen los datos</p>
                    </div>
                    <canvas id="tokenChart" style="display: none;"></canvas>
                </div>
                
                <h3 style="margin: 25px 0 15px; color: var(--primary);" class="lang" data-es="üìä Evoluci√≥n de la Distribuci√≥n en el Tiempo" data-ca="üìä Evoluci√≥ de la Distribuci√≥ en el Temps">üìä Evoluci√≥n de la Distribuci√≥n en el Tiempo</h3>
                <div class="timeline-container">
                    <div class="chart-placeholder" id="timeline-chart-placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path>
                        </svg>
                        <h3 class="lang" data-es="Cargando gr√°fico..." data-ca="Carregant gr√†fic...">Cargando gr√°fico...</h3>
                        <p class="lang" data-es="El gr√°fico de evoluci√≥n se mostrar√° aqu√≠" data-ca="El gr√†fic d'evoluci√≥ es mostrar√† aqu√≠">El gr√°fico de evoluci√≥n se mostrar√° aqu√≠</p>
                    </div>
                    <canvas id="timelineChart" style="display: none;"></canvas>
                </div>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" id="total-tokens">1,000,000</div>
                        <div class="stat-label lang" data-es="Tokens Totales" data-ca="Tokens Totals">Tokens Totales</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="circulating-supply">400,000</div>
                        <div class="stat-label lang" data-es="En Circulaci√≥n" data-ca="En Circulaci√≥">En Circulaci√≥n</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="vesting-tokens">250,000</div>
                        <div class="stat-label lang" data-es="Con Vesting" data-ca="Amb Vesting">Con Vesting</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="phases-count">4</div>
                        <div class="stat-label lang" data-es="Fases del Modelo" data-ca="Fases del Model">Fases del Modelo</div>
                    </div>
                </div>
                
                <h3 style="margin: 25px 0 15px; color: var(--primary);" class="lang" data-es="üë• Distribuci√≥n Actual por Stakeholders" data-ca="üë• Distribuci√≥ Actual per Stakeholders">üë• Distribuci√≥n Actual por Stakeholders</h3>
                <div id="stakeholder-grid" class="stakeholder-grid">
                    <!-- Stakeholders will be populated here -->
                </div>
                
                <div class="integration-section" style="margin-top: 30px;">
                    <h3 class="lang" data-es="üí° Modelo Fibonacci de Diluci√≥n" data-ca="üí° Model Fibonacci de Diluci√≥">üí° Modelo Fibonacci de Diluci√≥n</h3>
                    <p class="lang" data-es="Nuestro modelo Fibonacci permite una diluci√≥n progresiva y predecible de la participaci√≥n inicial. En cada fase, la diluci√≥n sigue la secuencia de Fibonacci (1, 1, 2, 3, 5, 8...), lo que significa que la diluci√≥n inicial es menor y aumenta gradualmente a medida que el proyecto madura y necesita atraer nuevos stakeholders. Esto protege a los inversores iniciales mientras permite la incorporaci√≥n de talento, proveedores y clientes a lo largo del tiempo." data-ca="El nostre model Fibonacci permet una diluci√≥ progressiva i previsible de la participaci√≥ inicial. A cada fase, la diluci√≥ segueix la seq√º√®ncia de Fibonacci (1, 1, 2, 3, 5, 8...), cosa que significa que la diluci√≥ inicial √©s menor i augmenta gradualment a mesura que el projecte madura i necessita atreure nous stakeholders. Aix√≤ protegeix els inversors inicials mentre permet la incorporaci√≥ de talent, prove√Ødors i clients al llarg del temps.">Nuestro modelo Fibonacci permite una diluci√≥n progresiva y predecible de la participaci√≥n inicial. En cada fase, la diluci√≥n sigue la secuencia de Fibonacci (1, 1, 2, 3, 5, 8...), lo que significa que la diluci√≥n inicial es menor y aumenta gradualmente a medida que el proyecto madura y necesita atraer nuevos stakeholders. Esto protege a los inversores iniciales mientras permite la incorporaci√≥n de talento, proveedores y clientes a lo largo del tiempo.</p>
                    
                    <div class="phase-item">
                        <h4 class="lang" data-es="Fase 1: Lanzamiento (Meses 1-6)" data-ca="Fase 1: Llan√ßament (Mesos 1-6)">Fase 1: Lanzamiento (Meses 1-6)</h4>
                        <p class="lang" data-es="Diluci√≥n: 5% - Enfoque en validaci√≥n del modelo y primeros clientes" data-ca="Diluci√≥: 5% - Enfocament en validaci√≥ del model i primers clients">Diluci√≥n: 5% - Enfoque en validaci√≥n del modelo y primeros clientes</p>
                    </div>
                    
                    <div class="phase-item">
                        <h4 class="lang" data-es="Fase 2: Crecimiento (Meses 7-18)" data-ca="Fase 2: Creixement (Mesos 7-18)">Fase 2: Crecimiento (Meses 7-18)</h4>
                        <p class="lang" data-es="Diluci√≥n: 8% - Incorporaci√≥n de talento clave y expansi√≥n de mercado" data-ca="Diluci√≥: 8% - Incorporaci√≥ de talent clau i expansi√≥ de mercat">Diluci√≥n: 8% - Incorporaci√≥n de talento clave y expansi√≥n de mercado</p>
                    </div>
                    
                    <div class="phase-item">
                        <h4 class="lang" data-es="Fase 3: Escalado (Meses 19-36)" data-ca="Fase 3: Escalat (Mesos 19-36)">Fase 3: Escalado (Meses 19-36)</h4>
                        <p class="lang" data-es="Diluci√≥n: 13% - Expansi√≥n internacional y nuevos productos/servicios" data-ca="Diluci√≥: 13% - Expansi√≥ internacional i nous productes/serveis">Diluci√≥n: 13% - Expansi√≥n internacional y nuevos productos/servicios</p>
                    </div>
                    
                    <div class="phase-item">
                        <h4 class="lang" data-es="Fase 4: Madurez (Meses 37+)" data-ca="Fase 4: Maduresa (Mesos 37+)">Fase 4: Madurez (Meses 37+)</h4>
                        <p class="lang" data-es="Diluci√≥n: 21% - Consolidaci√≥n y nuevos mercados" data-ca="Diluci√≥: 21% - Consolidaci√≥ i nous mercats">Diluci√≥n: 21% - Consolidaci√≥n y nuevos mercados</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <h3 class="lang" data-es="TeamTowers Hum√†" data-ca="TeamTowers Hum√†">TeamTowers Hum√†</h3>
                <p class="lang" data-es="De las torres humanas a las organizaciones humanas. Consultor√≠a estrat√©gica de RRHH con enfoque humanista desde Vilafranca del Pened√®s." data-ca="De les torres humanes a les organitzacions humanes. Consultoria estrat√®gica de RRHH amb enfocament humanista des de Vilafranca del Pened√®s.">De las torres humanas a las organizaciones humanas. Consultor√≠a estrat√©gica de RRHH con enfoque humanista desde Vilafranca del Pened√®s.</p>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Servicios" data-ca="Serveis">Servicios</h3>
                <ul class="footer-links">
                    <li><a href="https://teamtowershuma.com/" class="lang" data-es="TeamTowers" data-ca="TeamTowers">TeamTowers</a></li>
                    <li><a href="https://teamtowershuma.com/valor" class="lang" data-es="Value Network Analysis" data-ca="Value Network Analysis">Value Network Analysis</a></li>
                    <li><a href="https://teamtowershuma.com/coops" class="lang" data-es="Comunidades de Pr√°ctica" data-ca="Comunitats de Pr√†ctica">Comunidades de Pr√°ctica</a></li>
                    <li><a href="https://teamtowershuma.com/rrhh" class="lang" data-es="Business Partner RRHH" data-ca="Business Partner RRHH">Business Partner RRHH</a></li>
                    <li><a href="https://teamtowershuma.com/masia" class="lang" data-es="La Masia" data-ca="La Masia">La Masia</a></li>
                    <li><a href="https://teamtowershuma.com/sistema_integral" class="lang" data-es="Sistema Integral" data-ca="Sistema Integral">Sistema Integral</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Apps" data-ca="Apps">Apps</h3>
                <ul class="footer-links">
                    <li><a href="https://teamtowershuma.com/app" class="lang" data-es="App VNA" data-ca="App VNA">App VNA</a></li>
                    <li><a href="https://teamtowershuma.com/app_comptabilitat" class="lang" data-es="App Contabilidad de Valor" data-ca="App Comptabilitat de Valor">App Contabilidad de Valor</a></li>
                    <li><a href="https://teamtowershuma.com/app_coops" class="lang" data-es="App Comunidades de Pr√°ctica" data-ca="App Comunitats de Pr√†ctica">App Comunidades de Pr√°ctica</a></li>
                    <li><a href="#" class="lang" data-es="App Tokenomics" data-ca="App Tokenomics">App Tokenomics</a></li>
                    <li><a href="https://cursovna.netlify.app/" target="_blank" class="lang" data-es="Curso de VNA" data-ca="Curs de VNA">Curso de VNA</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Contacto" data-ca="Contacte">Contacto</h3>
                <ul class="footer-links">
                    <li>Vilafranca del Pened√®s, Barcelona</li>
                    <li>+34 629 86 77 15</li>
                    <li>
                        <a href="mailto:asolache@mac.com" style="color: var(--accent); font-weight: 600;">
                            <span class="lang" data-es="Enviar mensaje" data-ca="Enviar missatge">Enviar mensaje</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/alvarosolache" target="_blank" style="color: var(--accent); font-weight: 600;">LinkedIn</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p class="lang" data-es="¬© 2026 TeamTowers Hum√†. Todos los derechos reservados. Sistema Token√≥mico para proyectos de La Masia con distribuci√≥n transparente y modelo Fibonacci de diluci√≥n progresiva." data-ca="¬© 2026 TeamTowers Hum√†. Tots els drets reservats. Sistema Token√≤mic per a projectes de La Masia amb distribuci√≥ transparent i model Fibonacci de diluci√≥ progressiva.">¬© 2026 TeamTowers Hum√†. Todos los derechos reservados. Sistema Token√≥mico para proyectos de La Masia con distribuci√≥n transparente y modelo Fibonacci de diluci√≥n progresiva.</p>
        </div>
    </footer>
    
    <script>
        // ========== TEST-DRIVEN DEVELOPMENT FRAMEWORK ==========
        const testSuite = {
            results: [],
            assert: {
                equals: function(actual, expected, testName) {
                    const passed = actual === expected;
                    this.results.push({
                        name: testName,
                        passed: passed,
                        actual: actual,
                        expected: expected
                    });
                    return passed;
                },
                truthy: function(actual, testName) {
                    const passed = !!actual;
                    this.results.push({
                        name: testName,
                        passed: passed,
                        actual: actual,
                        expected: 'truthy value'
                    });
                    return passed;
                },
                falsy: function(actual, testName) {
                    const passed = !actual;
                    this.results.push({
                        name: testName,
                        passed: passed,
                        actual: actual,
                        expected: 'falsy value'
                    });
                    return passed;
                },
                type: function(actual, expectedType, testName) {
                    const actualType = typeof actual;
                    const passed = actualType === expectedType;
                    this.results.push({
                        name: testName,
                        passed: passed,
                        actual: actualType,
                        expected: expectedType
                    });
                    return passed;
                }
            },
            runTests: function() {
                this.results = [];
                
                // Test 1: Chart.js is loaded
                this.assert.truthy(typeof Chart !== 'undefined', "Chart.js library is loaded");
                
                // Test 2: DOM elements exist
                this.assert.truthy(document.getElementById('tokenChart'), "Token Chart canvas exists");
                this.assert.truthy(document.getElementById('timelineChart'), "Timeline Chart canvas exists");
                this.assert.truthy(document.getElementById('stakeholder-grid'), "Stakeholder grid exists");
                
                // Test 3: Initial state
                this.assert.equals(tokenomicsData.stakeholders.length, 4, "Initial stakeholders count is 4");
                this.assert.equals(tokenomicsData.totalSupply, 1000000, "Initial total supply is 1,000,000");
                this.assert.equals(tokenomicsData.isImportMode, false, "Initial mode is simulation (not import)");
                
                // Test 4: Default example stakeholders have correct structure
                if (tokenomicsData.stakeholders.length > 0) {
                    const firstStakeholder = tokenomicsData.stakeholders[0];
                    this.assert.truthy(firstStakeholder.id, "Stakeholder has id");
                    this.assert.truthy(firstStakeholder.name, "Stakeholder has name");
                    this.assert.truthy(firstStakeholder.type, "Stakeholder has type");
                    this.assert.truthy(typeof firstStakeholder.percentage === 'number', "Stakeholder has percentage as number");
                    this.assert.truthy(typeof firstStakeholder.tokens === 'number', "Stakeholder has tokens as number");
                }
                
                // Test 5: CSV parsing function exists
                this.assert.truthy(typeof processCSV === 'function', "processCSV function exists");
                this.assert.truthy(typeof previewCSV === 'function', "previewCSV function exists");
                
                // Test 6: Charts are initialized
                this.assert.truthy(tokenChart !== null, "Token chart is initialized");
                this.assert.truthy(timelineChart !== null, "Timeline chart is initialized");
                
                // Test 7: Language functionality
                this.assert.equals(document.documentElement.lang, 'es', "Default language is Spanish");
                
                return this.results;
            },
            displayResults: function(results) {
                const testResultsDiv = document.getElementById('test-results');
                testResultsDiv.style.display = 'block';
                testResultsDiv.innerHTML = '';
                
                let passedCount = 0;
                let failedCount = 0;
                
                results.forEach(result => {
                    const resultDiv = document.createElement('div');
                    resultDiv.className = result.passed ? 'test-pass' : 'test-fail';
                    resultDiv.innerHTML = `[${result.passed ? '‚úì PASS' : '‚úó FAIL'}] ${result.name}<br/>` +
                        `   Expected: ${result.expected}<br/>` +
                        `   Actual: ${result.actual}`;
                    testResultsDiv.appendChild(resultDiv);
                    
                    if (result.passed) passedCount++;
                    else failedCount++;
                });
                
                // Summary
                const summary = document.createElement('div');
                summary.style.fontWeight = 'bold';
                summary.style.marginTop = '15px';
                summary.style.paddingTop = '10px';
                summary.style.borderTop = '1px solid #ddd';
                summary.innerHTML = `Resultados: ${passedCount} pasadas, ${failedCount} fallidas de ${results.length} pruebas`;
                testResultsDiv.appendChild(summary);
                
                // Alert summary
                if (failedCount === 0) {
                    alert(`‚úÖ ¬°Todas las pruebas pasaron! (${passedCount}/${results.length})\n\nLa aplicaci√≥n est√° funcionando correctamente en tu navegador.`);
                } else {
                    alert(`‚ö†Ô∏è Algunas pruebas fallaron (${failedCount}/${results.length}).\n\nRevisa los resultados en la secci√≥n de pruebas.`);
                }
            }
        };
        
        // ========== APPLICATION STATE AND FUNCTIONS ==========
        // Estado de la aplicaci√≥n
        let tokenomicsData = {
            tokenName: "MASIA",
            tokenSymbol: "MSA",
            totalSupply: 1000000,
            distributionModel: "fibonacci",
            initialDistribution: {
                investors: 40,
                team: 25,
                reserve: 20,
                community: 15
            },
            stakeholders: [],
            phases: [
                { name: "Fase 1: Lanzamiento", months: "1-6", dilution: 5 },
                { name: "Fase 2: Crecimiento", months: "7-18", dilution: 8 },
                { name: "Fase 3: Escalado", months: "19-36", dilution: 13 },
                { name: "Fase 4: Madurez", months: "37+", dilution: 21 }
            ],
            timelineData: null,
            isImportMode: false,
            importedData: null,
            csvContent: null
        };
        
        let tokenChart = null;
        let timelineChart = null;
        let chartsInitialized = false;
        
        // Wait for Chart.js to load and DOM to be ready
        window.addEventListener('DOMContentLoaded', function() {
            // Check if Chart.js is available
            if (typeof Chart === 'undefined') {
                console.error('Chart.js failed to load');
                showChartError('token-chart-placeholder', 'Chart.js no se pudo cargar. Por favor, recarga la p√°gina.');
                showChartError('timeline-chart-placeholder', 'Chart.js no se pudo cargar. Por favor, recarga la p√°gina.');
                return;
            }
            
            // Initialize the application
            initApplication();
        });
        
        // Initialize the entire application
        function initApplication() {
            // Setup language selector
            setupLanguageSelector();
            
            // Load saved data
            loadSavedData();
            
            // Initialize charts with error handling
            initCharts();
            
            // Setup event listeners
            setupEventListeners();
            
            // Show default example if no data is loaded
            if (tokenomicsData.stakeholders.length === 0) {
                showDefaultExample();
            }
            
            // Update visualizations
            updateVisualizations();
            
            // Setup test button
            document.getElementById('run-tests').addEventListener('click', function() {
                const results = testSuite.runTests();
                testSuite.displayResults(results);
            });
        }
        
        // Setup language selector
        function setupLanguageSelector() {
            const langButtons = document.querySelectorAll('.lang-btn');
            const translatableElements = document.querySelectorAll('[data-es], [data-ca]');
            
            // Set initial language based on browser settings or default to Spanish
            const userLang = navigator.language.startsWith('ca') ? 'ca' : 'es';
            setActiveLanguage(userLang);
            
            // Add click event to language buttons
            langButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const selectedLang = this.getAttribute('data-lang');
                    setActiveLanguage(selectedLang);
                    
                    // Update active button
                    langButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Set active language
            function setActiveLanguage(lang) {
                // Update all translatable elements
                translatableElements.forEach(element => {
                    if (element.hasAttribute(`data-${lang}`)) {
                        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                            element.placeholder = element.getAttribute(`data-${lang}`);
                        } else {
                            // Use innerHTML to allow HTML content in translations
                            element.innerHTML = element.getAttribute(`data-${lang}`);
                        }
                    }
                });
                
                // Update HTML lang attribute
                document.documentElement.setAttribute('lang', lang);
            }
        }
        
        // Initialize charts with error handling
        function initCharts() {
            try {
                // Token Chart
                const tokenCtx = document.getElementById('tokenChart');
                if (tokenCtx) {
                    // Hide placeholder and show canvas
                    document.getElementById('token-chart-placeholder').style.display = 'none';
                    tokenCtx.style.display = 'block';
                    
                    tokenChart = new Chart(tokenCtx, {
                        type: 'doughnut',
                        data: {
                            labels: [],
                            datasets: [{
                                data: [],
                                backgroundColor: [
                                    'rgba(245, 158, 11, 0.85)',
                                    'rgba(16, 185, 129, 0.85)',
                                    'rgba(139, 92, 246, 0.85)',
                                    'rgba(59, 130, 246, 0.85)',
                                    'rgba(245, 158, 11, 0.6)',
                                    'rgba(16, 185, 129, 0.6)',
                                    'rgba(139, 92, 246, 0.6)',
                                    'rgba(59, 130, 246, 0.6)'
                                ],
                                borderWidth: 2,
                                borderColor: '#ffffff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        padding: 20,
                                        font: {
                                            size: 14,
                                            family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.raw || 0;
                                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                            const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                                            
                                            return `${label}: ${percentage}% (${Math.round(value).toLocaleString()} tokens)`;
                                        }
                                    }
                                }
                            },
                            animation: {
                                animateScale: true,
                                animateRotate: true
                            }
                        }
                    });
                }
                
                // Timeline Chart
                const timelineCtx = document.getElementById('timelineChart');
                if (timelineCtx) {
                    // Hide placeholder and show canvas
                    document.getElementById('timeline-chart-placeholder').style.display = 'none';
                    timelineCtx.style.display = 'block';
                    
                    timelineChart = new Chart(timelineCtx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Inversors' : 'Inversores',
                                    data: [],
                                    borderColor: 'rgba(245, 158, 11, 1)',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Equip' : 'Equipo',
                                    data: [],
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Reserva' : 'Reserva',
                                    data: [],
                                    borderColor: 'rgba(139, 92, 246, 1)',
                                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Comunitat' : 'Comunidad',
                                    data: [],
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.3
                                },
                                // For import mode
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Stakeholders Actuals' : 'Stakeholders Actuales',
                                    data: [],
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    fill: true,
                                    tension: 0.3,
                                    hidden: true
                                },
                                {
                                    label: document.documentElement.lang === 'ca' ? 'Futurs Contribu√Ødors' : 'Futuros Contribuyentes',
                                    data: [],
                                    borderColor: 'rgba(245, 158, 11, 1)',
                                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                    fill: true,
                                    tension: 0.3,
                                    hidden: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        padding: 15,
                                        font: {
                                            size: 13,
                                            family: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
                                        }
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: document.documentElement.lang === 'ca' ? 'Percentatge (%)' : 'Porcentaje (%)'
                                    },
                                    max: 100
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: document.documentElement.lang === 'ca' ? 'Fases del Projecte' : 'Fases del Proyecto'
                                    }
                                }
                            },
                            interaction: {
                                mode: 'nearest',
                                axis: 'x',
                                intersect: false
                            }
                        }
                    });
                }
                
                chartsInitialized = true;
                console.log('Charts initialized successfully');
            } catch (error) {
                console.error('Error initializing charts:', error);
                showChartError('token-chart-placeholder', 'Error al inicializar el gr√°fico: ' + error.message);
                showChartError('timeline-chart-placeholder', 'Error al inicializar el gr√°fico: ' + error.message);
            }
        }
        
        // Show chart error message
        function showChartError(elementId, message) {
            const placeholder = document.getElementById(elementId);
            if (placeholder) {
                placeholder.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    <h3>Error</h3>
                    <p>${message}</p>
                    <button onclick="location.reload()" class="btn btn-secondary" style="margin-top: 15px; width: auto;">
                        <span>‚ü≥</span> Recargar P√°gina
                    </button>
                `;
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Distribution sliders
            document.getElementById('investors-slider').addEventListener('input', updateDistribution);
            document.getElementById('team-slider').addEventListener('input', updateDistribution);
            document.getElementById('reserve-slider').addEventListener('input', updateDistribution);
            document.getElementById('community-slider').addEventListener('input', updateDistribution);
            
            // Simulation button
            document.getElementById('simulate-tokenomics').addEventListener('click', simulateTokenomics);
            
            // Import buttons
            document.getElementById('import-vna').addEventListener('click', importVNA);
            document.getElementById('import-value-csv').addEventListener('click', () => {
                document.getElementById('value-csv-file').click();
            });
            document.getElementById('value-csv-file').addEventListener('change', previewCSV);
            document.getElementById('process-csv').addEventListener('click', processCSV);
            document.getElementById('import-coops').addEventListener('click', importCoPs);
            
            // Export buttons
            document.getElementById('export-json').addEventListener('click', exportJSON);
            document.getElementById('export-smart-contract').addEventListener('click', exportSmartContract);
            
            // Reset button
            document.getElementById('reset-data').addEventListener('click', resetData);
            
            // Distribution model change
            document.getElementById('distribution-model').addEventListener('change', function() {
                tokenomicsData.distributionModel = this.value;
                saveData();
            });
        }
        
        // Update distribution values when sliders change
        function updateDistribution() {
            const investorsSlider = document.getElementById('investors-slider');
            const teamSlider = document.getElementById('team-slider');
            const reserveSlider = document.getElementById('reserve-slider');
            const communitySlider = document.getElementById('community-slider');
            
            // Calculate total
            const total = parseInt(investorsSlider.value) + 
                         parseInt(teamSlider.value) + 
                         parseInt(reserveSlider.value) + 
                         parseInt(communitySlider.value);
            
            // If exceeds 100%, adjust proportionally
            if (total > 100) {
                const ratio = 100 / total;
                investorsSlider.value = Math.round(parseInt(investorsSlider.value) * ratio);
                teamSlider.value = Math.round(parseInt(teamSlider.value) * ratio);
                reserveSlider.value = Math.round(parseInt(reserveSlider.value) * ratio);
                communitySlider.value = Math.round(parseInt(communitySlider.value) * ratio);
            }
            
            // Update displayed values
            document.getElementById('investors-value').textContent = `${investorsSlider.value}%`;
            document.getElementById('team-value').textContent = `${teamSlider.value}%`;
            document.getElementById('reserve-value').textContent = `${reserveSlider.value}%`;
            document.getElementById('community-value').textContent = `${communitySlider.value}%`;
        }
        
        // Preview CSV file
        function previewCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const previewDiv = document.getElementById('csv-preview');
                previewDiv.style.display = 'block';
                previewDiv.innerHTML = '<div class="csv-row csv-header"><div class="csv-cell">Rol</div><div class="csv-cell">Entregable</div><div class="csv-cell">Valor</div></div>';
                
                // Parse CSV and show first 5 rows
                const rows = parseCSV(content);
                const headers = rows[0] ? rows[0].map(h => h.trim().toLowerCase()) : [];
                
                // Find column indices
                const roleIndex = headers.findIndex(h => h.includes('rol'));
                const deliverableIndex = headers.findIndex(h => h.includes('entregable') || h.includes('descripci√≥'));
                const valueIndex = headers.findIndex(h => h.includes('valor'));
                
                // Show up to 5 data rows
                const maxRows = Math.min(5, rows.length - 1);
                for (let i = 1; i <= maxRows && i < rows.length; i++) {
                    const cells = rows[i];
                    if (cells.length > Math.max(roleIndex, deliverableIndex, valueIndex)) {
                        const rowDiv = document.createElement('div');
                        rowDiv.className = 'csv-row';
                        rowDiv.innerHTML = `
                            <div class="csv-cell">${cells[roleIndex] || ''}</div>
                            <div class="csv-cell">${cells[deliverableIndex] || ''}</div>
                            <div class="csv-cell">${cells[valueIndex] || ''}</div>
                        `;
                        previewDiv.appendChild(rowDiv);
                    }
                }
                
                // Save content for processing
                tokenomicsData.csvContent = content;
            };
            reader.readAsText(file);
        }
        
        // Parse CSV content - handles quoted fields and different line endings
        function parseCSV(str) {
            const rows = [];
            let currentRow = [];
            let currentValue = '';
            let inQuotes = false;
            let i = 0;
            
            // Normalize line endings
            str = str.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
            
            while (i < str.length) {
                const char = str[i];
                
                if (char === '"' && (i === 0 || str[i-1] !== '\\')) {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    currentRow.push(currentValue.trim());
                    currentValue = '';
                } else if (char === '\n' && !inQuotes) {
                    currentRow.push(currentValue.trim());
                    rows.push(currentRow);
                    currentRow = [];
                    currentValue = '';
                } else {
                    currentValue += char;
                }
                
                i++;
            }
            
            // Push the last value and row
            if (currentValue.trim() !== '') {
                currentRow.push(currentValue.trim());
            }
            if (currentRow.length > 0) {
                rows.push(currentRow);
            }
            
            return rows;
        }
        
        // Process CSV file
        function processCSV() {
            if (!tokenomicsData.csvContent) {
                alert(document.documentElement.lang === 'ca' ? 
                    'Selecciona un archivo CSV primero' : 
                    'Selecciona un archivo CSV primero');
                return;
            }
            
            try {
                // Show loading state
                const processBtn = document.getElementById('process-csv');
                processBtn.classList.add('loading');
                processBtn.disabled = true;
                
                // Parse CSV
                const rows = parseCSV(tokenomicsData.csvContent);
                if (rows.length < 2) {
                    throw new Error(document.documentElement.lang === 'ca' ? 
                        'El archivo CSV est√° vac√≠o o no tiene datos v√°lidos' : 
                        'El archivo CSV est√° vac√≠o o no tiene datos v√°lidos');
                }
                
                const headers = rows[0].map(h => h.trim().replace(/"/g, '').toLowerCase());
                
                // Find column indices
                const roleIndex = headers.findIndex(h => h.includes('rol'));
                const valueIndex = headers.findIndex(h => h.includes('valor'));
                
                if (roleIndex === -1 || valueIndex === -1) {
                    throw new Error(document.documentElement.lang === 'ca' ? 
                        'El archivo CSV no tiene las columnas necesarias (Rol, Valor)' : 
                        'El archivo CSV no tiene las columnas necesarias (Rol, Valor)');
                }
                
                // Aggregate value by role
                const roleValues = {};
                let totalValue = 0;
                
                for (let i = 1; i < rows.length; i++) {
                    const cells = rows[i];
                    if (cells.length <= Math.max(roleIndex, valueIndex)) continue;
                    
                    // Normalize role name
                    let role = cells[roleIndex].replace('@', '').trim().toLowerCase();
                    
                    // Fix common typos
                    if (role.includes('inverosr') || role.includes('inversor')) role = 'inversor';
                    if (role.includes('fundador') || role.includes('equipo')) role = 'equipo';
                    
                    const value = parseFloat(cells[valueIndex]) || 0;
                    
                    if (value > 0) {
                        roleValues[role] = (roleValues[role] || 0) + value;
                        totalValue += value;
                    }
                }
                
                if (totalValue === 0) {
                    throw new Error(document.documentElement.lang === 'ca' ? 
                        'No se encontraron valores v√°lidos en el CSV' : 
                        'No se encontraron valores v√°lidos en el CSV');
                }
                
                // Calculate token distribution based on value contributed
                const stakeholders = [];
                let otherValue = 0;
                const maxStakeholders = 8;
                
                // Sort roles by value and take top ones
                const sortedRoles = Object.entries(roleValues)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, maxStakeholders);
                
                // Roles not in top go to "Others"
                const allRoles = Object.entries(roleValues);
                for (let i = maxStakeholders; i < allRoles.length; i++) {
                    otherValue += allRoles[i][1];
                }
                
                // Create stakeholders for top roles
                sortedRoles.forEach(([role, value]) => {
                    const percentage = (value / totalValue) * 100;
                    const tokens = Math.round((value / totalValue) * tokenomicsData.totalSupply);
                    
                    // Determine stakeholder type
                    let type = 'client';
                    if (role.includes('inversor') || role.includes('invers')) type = 'investor';
                    else if (role.includes('equip') || role.includes('team') || role.includes('fundador') || role.includes('equipo')) type = 'team';
                    else if (role.includes('proveedor') || role.includes('supplier')) type = 'supplier';
                    
                    // Capitalize role name
                    const roleName = role.charAt(0).toUpperCase() + role.slice(1);
                    
                    stakeholders.push({
                        id: role,
                        name: roleName,
                        type: type,
                        percentage: parseFloat(percentage.toFixed(2)),
                        tokens: tokens,
                        vesting: document.documentElement.lang === 'ca' ? 'Basat en entregables' : 'Basado en entregables',
                        role: document.documentElement.lang === 'ca' ? 'Aportaci√≥ de valor segons registre' : 'Aportaci√≥n de valor seg√∫n registro',
                        value: value
                    });
                });
                
                // Add "Others" if there are remaining roles
                if (otherValue > 0) {
                    const otherPercentage = (otherValue / totalValue) * 100;
                    const otherTokens = Math.round((otherValue / totalValue) * tokenomicsData.totalSupply);
                    
                    stakeholders.push({
                        id: 'others',
                        name: document.documentElement.lang === 'ca' ? 'Altres Stakeholders' : 'Otros Stakeholders',
                        type: 'client',
                        percentage: parseFloat(otherPercentage.toFixed(2)),
                        tokens: otherTokens,
                        vesting: document.documentElement.lang === 'ca' ? 'Basat en entregables' : 'Basado en entregables',
                        role: document.documentElement.lang === 'ca' ? 'Aportaci√≥ de valor col¬∑lectiva' : 'Aportaci√≥n de valor colectiva',
                        value: otherValue
                    });
                }
                
                // Update tokenomics data
                tokenomicsData.stakeholders = stakeholders;
                tokenomicsData.isImportMode = true;
                tokenomicsData.importedData = {
                    totalValue: totalValue,
                    roleValues: roleValues
                };
                
                // Calculate timeline evolution
                calculateTimeline();
                
                // Save and update
                saveData();
                updateVisualizations();
                
                // Success message
                alert(document.documentElement.lang === 'ca' ? 
                    `S'han processat ${Object.keys(roleValues).length} stakeholders del CSV. La distribuci√≥ de tokens s'ha calculat segons el valor aportat.` : 
                    `Se han procesado ${Object.keys(roleValues).length} stakeholders del CSV. La distribuci√≥n de tokens se ha calculado seg√∫n el valor aportado.`);
            } catch (error) {
                console.error('Error processing CSV:', error);
                alert(document.documentElement.lang === 'ca' ? 
                    `Error en processar el CSV: ${error.message}` : 
                    `Error al procesar el CSV: ${error.message}`);
            } finally {
                // Hide loading state
                const processBtn = document.getElementById('process-csv');
                processBtn.classList.remove('loading');
                processBtn.disabled = false;
            }
        }
        
        // Show default example
        function showDefaultExample() {
            // Generate simulated stakeholders based on initial distribution
            tokenomicsData.stakeholders = [
                {
                    id: 'investors',
                    name: document.documentElement.lang === 'ca' ? 'Inversors Inicials' : 'Inversores Iniciales',
                    type: 'investor',
                    percentage: tokenomicsData.initialDistribution.investors,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.investors / 100),
                    vesting: '4 a√±os con 1 a√±o de cliff',
                    role: 'Capital inicial y recursos',
                    value: 400000
                },
                {
                    id: 'team',
                    name: document.documentElement.lang === 'ca' ? 'Equip Fundador' : 'Equipo Fundador',
                    type: 'team',
                    percentage: tokenomicsData.initialDistribution.team,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.team / 100),
                    vesting: '4 a√±os con 1 a√±o de cliff',
                    role: 'Liderazgo y ejecuci√≥n',
                    value: 250000
                },
                {
                    id: 'reserve',
                    name: document.documentElement.lang === 'ca' ? 'Reserva del Projecte' : 'Reserva del Proyecto',
                    type: 'reserve',
                    percentage: tokenomicsData.initialDistribution.reserve,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.reserve / 100),
                    vesting: 'Liberaci√≥n programada',
                    role: 'Desarrollo futuro y expansi√≥n',
                    value: 200000
                },
                {
                    id: 'community',
                    name: document.documentElement.lang === 'ca' ? 'Comunitat (Staking)' : 'Comunidad (Staking)',
                    type: 'community',
                    percentage: tokenomicsData.initialDistribution.community,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.community / 100),
                    vesting: 'Recompensas por participaci√≥n',
                    role: 'Validaci√≥n y gobernanza',
                    value: 150000
                }
            ];
            
            tokenomicsData.isImportMode = false;
            tokenomicsData.importedData = null;
            
            // Calculate timeline evolution
            calculateTimeline();
            
            // Save and update
            saveData();
            updateVisualizations();
        }
        
        // Simulate tokenomics
        function simulateTokenomics() {
            // If in import mode, ask if user wants to switch
            if (tokenomicsData.isImportMode) {
                if (!confirm(document.documentElement.lang === 'ca' ? 
                    'Est√†s en mode d\'importaci√≥ de CSV. Si continues, es perdran les dades importades i es tornar√† al mode de simulaci√≥. Vols continuar?' : 
                    'Est√°s en modo de importaci√≥n de CSV. Si contin√∫as, se perder√°n los datos importados y se volver√° al modo de simulaci√≥n. ¬øQuieres continuar?')) {
                    return;
                }
                
                // Reset import mode
                tokenomicsData.isImportMode = false;
                tokenomicsData.importedData = null;
                document.getElementById('csv-preview').style.display = 'none';
                document.getElementById('value-csv-file').value = '';
            }
            
            // Update data
            tokenomicsData.tokenName = document.getElementById('token-name').value;
            tokenomicsData.tokenSymbol = document.getElementById('token-symbol').value;
            tokenomicsData.totalSupply = parseInt(document.getElementById('total-supply').value);
            tokenomicsData.distributionModel = document.getElementById('distribution-model').value;
            
            tokenomicsData.initialDistribution = {
                investors: parseInt(document.getElementById('investors-slider').value),
                team: parseInt(document.getElementById('team-slider').value),
                reserve: parseInt(document.getElementById('reserve-slider').value),
                community: parseInt(document.getElementById('community-slider').value)
            };
            
            // Generate simulated stakeholders
            generateStakeholders();
            
            // Calculate timeline evolution
            calculateTimeline();
            
            // Save and update
            saveData();
            updateVisualizations();
            
            // Success message
            alert(document.documentElement.lang === 'ca' ? 
                'Simulaci√≥ completada! S\'ha generat la distribuci√≥ de tokens i l\'evoluci√≥ temporal.' : 
                '¬°Simulaci√≥n completada! Se ha generado la distribuci√≥n de tokens y la evoluci√≥n temporal.');
        }
        
        // Generate simulated stakeholders
        function generateStakeholders() {
            tokenomicsData.stakeholders = [
                {
                    id: 'investors',
                    name: document.documentElement.lang === 'ca' ? 'Inversors Inicials' : 'Inversores Iniciales',
                    type: 'investor',
                    percentage: tokenomicsData.initialDistribution.investors,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.investors / 100),
                    vesting: '4 a√±os con 1 a√±o de cliff',
                    role: 'Capital inicial y recursos',
                    value: tokenomicsData.totalSupply * tokenomicsData.initialDistribution.investors / 100
                },
                {
                    id: 'team',
                    name: document.documentElement.lang === 'ca' ? 'Equip Fundador' : 'Equipo Fundador',
                    type: 'team',
                    percentage: tokenomicsData.initialDistribution.team,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.team / 100),
                    vesting: '4 a√±os con 1 a√±o de cliff',
                    role: 'Liderazgo y ejecuci√≥n',
                    value: tokenomicsData.totalSupply * tokenomicsData.initialDistribution.team / 100
                },
                {
                    id: 'reserve',
                    name: document.documentElement.lang === 'ca' ? 'Reserva del Projecte' : 'Reserva del Proyecto',
                    type: 'reserve',
                    percentage: tokenomicsData.initialDistribution.reserve,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.reserve / 100),
                    vesting: 'Liberaci√≥n programada',
                    role: 'Desarrollo futuro y expansi√≥n',
                    value: tokenomicsData.totalSupply * tokenomicsData.initialDistribution.reserve / 100
                },
                {
                    id: 'community',
                    name: document.documentElement.lang === 'ca' ? 'Comunitat (Staking)' : 'Comunidad (Staking)',
                    type: 'community',
                    percentage: tokenomicsData.initialDistribution.community,
                    tokens: Math.round(tokenomicsData.totalSupply * tokenomicsData.initialDistribution.community / 100),
                    vesting: 'Recompensas por participaci√≥n',
                    role: 'Validaci√≥n y gobernanza',
                    value: tokenomicsData.totalSupply * tokenomicsData.initialDistribution.community / 100
                }
            ];
        }
        
        // Calculate timeline evolution
        function calculateTimeline() {
            const labels = [];
            const datasets = {
                investors: [],
                team: [],
                reserve: [],
                community: [],
                currentStakeholders: [],
                futureContributors: []
            };
            
            // If in import mode, use different calculation
            if (tokenomicsData.isImportMode && tokenomicsData.importedData) {
                let currentTotalSupply = tokenomicsData.totalSupply;
                let futureTokens = 0;
                
                // Initial point (phase 0)
                labels.push(document.documentElement.lang === 'ca' ? 'Ara' : 'Ahora');
                datasets.currentStakeholders.push(100);
                datasets.futureContributors.push(0);
                
                // Calculate for each phase
                tokenomicsData.phases.forEach((phase) => {
                    const dilution = phase.dilution / 100;
                    
                    // Calculate new tokens to mint
                    const newTokens = currentTotalSupply * dilution;
                    currentTotalSupply += newTokens;
                    futureTokens += newTokens;
                    
                    // Calculate percentages
                    const currentStakeholdersPercentage = parseFloat(((tokenomicsData.totalSupply / currentTotalSupply) * 100).toFixed(2));
                    const futureContributorsPercentage = parseFloat(((futureTokens / currentTotalSupply) * 100).toFixed(2));
                    
                    labels.push(phase.name);
                    datasets.currentStakeholders.push(currentStakeholdersPercentage);
                    datasets.futureContributors.push(futureContributorsPercentage);
                });
                
                tokenomicsData.timelineData = {
                    labels: labels,
                    datasets: datasets,
                    mode: 'import'
                };
            } else {
                // Traditional calculation for simulation mode
                let currentInvestors = tokenomicsData.initialDistribution.investors;
                let currentTeam = tokenomicsData.initialDistribution.team;
                let currentReserve = tokenomicsData.initialDistribution.reserve;
                let currentCommunity = tokenomicsData.initialDistribution.community;
                
                // Initial point
                labels.push(document.documentElement.lang === 'ca' ? 'Inici' : 'Inicio');
                datasets.investors.push(currentInvestors);
                datasets.team.push(currentTeam);
                datasets.reserve.push(currentReserve);
                datasets.community.push(currentCommunity);
                
                // Calculate for each phase
                tokenomicsData.phases.forEach((phase) => {
                    const dilution = phase.dilution / 100;
                    
                    // Apply dilution based on Fibonacci model
                    if (tokenomicsData.distributionModel === 'fibonacci') {
                        const investorsDilution = dilution * 0.6;
                        const teamDilution = dilution * 0.25;
                        const reserveDilution = dilution * 0.1;
                        const communityDilution = dilution * 0.05;
                        
                        currentInvestors *= (1 - investorsDilution);
                        currentTeam *= (1 - teamDilution);
                        currentReserve *= (1 - reserveDilution);
                        currentCommunity *= (1 - communityDilution);
                    } else if (tokenomicsData.distributionModel === 'linear') {
                        currentInvestors *= (1 - dilution/4);
                        currentTeam *= (1 - dilution/4);
                        currentReserve *= (1 - dilution/4);
                        currentCommunity *= (1 - dilution/4);
                    }
                    
                    labels.push(phase.name);
                    datasets.investors.push(Math.round(currentInvestors * 10) / 10);
                    datasets.team.push(Math.round(currentTeam * 10) / 10);
                    datasets.reserve.push(Math.round(currentReserve * 10) / 10);
                    datasets.community.push(Math.round(currentCommunity * 10) / 10);
                });
                
                tokenomicsData.timelineData = {
                    labels: labels,
                    datasets: datasets,
                    mode: 'simulation'
                };
            }
        }
        
        // Import VNA data
        function importVNA() {
            alert(document.documentElement.lang === 'ca' ? 
                'Funcionalitat en desenvolupament. Pr√≤ximament podr√†s importar dades directament des de l\'App VNA.' : 
                'Funcionalidad en desarrollo. Pr√≥ximamente podr√°s importar datos directamente desde la App VNA.');
        }
        
        // Import CoPs data
        function importCoPs() {
            alert(document.documentElement.lang === 'ca' ? 
                'Funcionalitat en desenvolupament. Pr√≤ximament podr√†s importar dades directament des de l\'App de Comunitats de Pr√†ctica.' : 
                'Funcionalidad en desarrollo. Pr√≥ximamente podr√°s importar datos directamente desde la App de Comunidades de Pr√°ctica.');
        }
        
        // Update visualizations
        function updateVisualizations() {
            // Update statistics
            document.getElementById('total-tokens').textContent = tokenomicsData.totalSupply.toLocaleString();
            
            if (tokenomicsData.isImportMode) {
                const circulating = tokenomicsData.stakeholders.reduce((sum, s) => sum + s.tokens, 0);
                document.getElementById('circulating-supply').textContent = circulating.toLocaleString();
                document.getElementById('vesting-tokens').textContent = '0';
            } else {
                document.getElementById('circulating-supply').textContent = Math.round(tokenomicsData.totalSupply * 0.4).toLocaleString();
                document.getElementById('vesting-tokens').textContent = Math.round(tokenomicsData.totalSupply * 0.25).toLocaleString();
            }
            
            document.getElementById('phases-count').textContent = tokenomicsData.phases.length;
            
            // Update charts if initialized
            if (chartsInitialized) {
                updateTokenChart();
                updateTimelineChart();
            }
            
            // Update stakeholder grid
            updateStakeholderGrid();
        }
        
        // Update token chart
        function updateTokenChart() {
            if (!tokenChart) return;
            
            const stakeholders = tokenomicsData.stakeholders.filter(s => s.percentage > 0);
            const labels = stakeholders.map(s => s.name);
            const data = stakeholders.map(s => s.percentage);
            
            tokenChart.data.labels = labels;
            tokenChart.data.datasets[0].data = data;
            tokenChart.update('none'); // Disable animation for better performance
        }
        
        // Update timeline chart
        function updateTimelineChart() {
            if (!timelineChart || !tokenomicsData.timelineData) return;
            
            // Reset all datasets
            timelineChart.data.datasets.forEach(dataset => {
                dataset.data = [];
                dataset.hidden = true;
            });
            
            if (tokenomicsData.timelineData.mode === 'import') {
                // Show only datasets for import mode
                timelineChart.data.datasets[4].data = tokenomicsData.timelineData.datasets.currentStakeholders;
                timelineChart.data.datasets[4].hidden = false;
                
                timelineChart.data.datasets[5].data = tokenomicsData.timelineData.datasets.futureContributors;
                timelineChart.data.datasets[5].hidden = false;
            } else {
                // Show datasets for simulation mode
                timelineChart.data.datasets[0].data = tokenomicsData.timelineData.datasets.investors;
                timelineChart.data.datasets[0].hidden = false;
                
                timelineChart.data.datasets[1].data = tokenomicsData.timelineData.datasets.team;
                timelineChart.data.datasets[1].hidden = false;
                
                timelineChart.data.datasets[2].data = tokenomicsData.timelineData.datasets.reserve;
                timelineChart.data.datasets[2].hidden = false;
                
                timelineChart.data.datasets[3].data = tokenomicsData.timelineData.datasets.community;
                timelineChart.data.datasets[3].hidden = false;
            }
            
            timelineChart.data.labels = tokenomicsData.timelineData.labels;
            timelineChart.update('none'); // Disable animation for better performance
        }
        
        // Update stakeholder grid
        function updateStakeholderGrid() {
            const grid = document.getElementById('stakeholder-grid');
            
            if (tokenomicsData.stakeholders.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <h3 class="lang" data-es="No hay stakeholders configurados a√∫n" data-ca="No hi ha stakeholders configurats encara">No hay stakeholders configurados a√∫n</h3>
                        <p class="lang" data-es="Importa tu CSV de Contabilidad de Valor o simula tu modelo token√≥mico para ver la distribuci√≥n entre stakeholders" data-ca="Importa el teu CSV de Comptabilitat de Valor o simula el teu model token√≤mic per veure la distribuci√≥ entre stakeholders">Importa tu CSV de Contabilidad de Valor o simula tu modelo token√≥mico para ver la distribuci√≥n entre stakeholders</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            tokenomicsData.stakeholders.forEach(stakeholder => {
                const percentage = stakeholder.percentage.toFixed(1);
                const tokens = stakeholder.tokens.toLocaleString();
                const typeClass = {
                    'investor': 'role-investor',
                    'team': 'role-team',
                    'supplier': 'role-supplier',
                    'client': 'role-client',
                    'reserve': 'role-supplier',
                    'community': 'role-client',
                    'others': 'role-client'
                }[stakeholder.type] || 'role-team';
                
                html += `
                    <div class="stakeholder-card">
                        <h4>${stakeholder.name}</h4>
                        <div class="percentage">${percentage}%</div>
                        <div class="tokens">${tokens} ${tokenomicsData.tokenSymbol}</div>
                        <p><span class="role-tag ${typeClass}">${stakeholder.role}</span></p>
                        <p><span class="role-tag vesting-badge">${stakeholder.vesting}</span></p>
                        ${stakeholder.value ? `<p><small>${document.documentElement.lang === 'ca' ? 'Valor aportat: ' : 'Valor aportado: '}${stakeholder.value.toLocaleString()} pts</small></p>` : ''}
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }
        
        // Export as JSON
        function exportJSON() {
            const dataStr = JSON.stringify(tokenomicsData, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            
            const exportFileDefaultName = `tokenomics-${tokenomicsData.tokenName}-${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', url);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.style.display = 'none';
            document.body.appendChild(linkElement);
            
            linkElement.click();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(linkElement);
                URL.revokeObjectURL(url);
            }, 100);
            
            alert(document.documentElement.lang === 'ca' ? 
                'Dades exportades correctament com a JSON' : 
                'Datos exportados correctamente como JSON');
        }
        
        // Export Smart Contract
        function exportSmartContract() {
            const contractCode = `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

/**
 * ${tokenomicsData.tokenName} Token (${tokenomicsData.tokenSymbol})
 * Tokenomics Model: ${tokenomicsData.distributionModel === 'fibonacci' ? 'Fibonacci Dilution' : 'Linear Dilution'}
 * Total Supply: ${tokenomicsData.totalSupply.toLocaleString()} ${tokenomicsData.tokenSymbol}
 */

contract ${tokenomicsData.tokenName}Token {
    string public name = "${tokenomicsData.tokenName}";
    string public symbol = "${tokenomicsData.tokenSymbol}";
    uint8 public decimals = 18;
    uint256 public totalSupply = ${tokenomicsData.totalSupply} * 10 ** 18;
    
    // Distribution phases based on Fibonacci sequence
    struct Phase {
        string name;
        uint256 startTime;
        uint256 endTime;
        uint256 dilutionPercentage;
    }
    
    Phase[] public phases;
    
    // Stakeholder allocations
    mapping(address => uint256) public balances;
    mapping(address => mapping(address => uint256)) public allowances;
    
    // Vesting schedules
    struct VestingSchedule {
        uint256 startTime;
        uint256 cliffTime;
        uint256 endTime;
        bool revocable;
    }
    
    mapping(address => VestingSchedule) public vestingSchedules;
    
    event Transfer(address indexed from, address indexed to, uint256 value);
    event Approval(address indexed owner, address indexed spender, uint256 value);
    event TokensReleased(address indexed holder, uint256 amount);
    
    constructor() {
        // Initial distribution
        ${tokenomicsData.isImportMode ? '// Distribution based on value contributed from Value Accounting App' : `
        // Investors: ${tokenomicsData.initialDistribution.investors}%
        // Team: ${tokenomicsData.initialDistribution.team}%
        // Reserve: ${tokenomicsData.initialDistribution.reserve}%
        // Community: ${tokenomicsData.initialDistribution.community}%
        `}
        
        // Setup vesting schedules
        // Setup phases based on Fibonacci dilution model
        
        emit Transfer(address(0), msg.sender, totalSupply);
    }
    
    // Standard ERC20 functions
    function transfer(address to, uint256 amount) public returns (bool) {
        _transfer(msg.sender, to, amount);
        return true;
    }
    
    function approve(address spender, uint256 amount) public returns (bool) {
        allowances[msg.sender][spender] = amount;
        emit Approval(msg.sender, spender, amount);
        return true;
    }
    
    function transferFrom(address from, address to, uint256 amount) public returns (bool) {
        uint256 allowed = allowances[from][msg.sender];
        require(allowed >= amount, "ERC20: insufficient allowance");
        
        allowances[from][msg.sender] = allowed - amount;
        _transfer(from, to, amount);
        return true;
    }
    
    function balanceOf(address account) public view returns (uint256) {
        return balances[account];
    }
    
    function allowance(address owner, address spender) public view returns (uint256) {
        return allowances[owner][spender];
    }
    
    // Vesting functions
    function releaseVestedTokens() public {
        VestingSchedule memory schedule = vestingSchedules[msg.sender];
        require(block.timestamp >= schedule.startTime, "Vesting: not started yet");
        
        uint256 vestedAmount = calculateVestedAmount(msg.sender);
        require(vestedAmount > 0, "Vesting: no tokens to release");
        
        balances[msg.sender] += vestedAmount;
        emit TokensReleased(msg.sender, vestedAmount);
    }
    
    function calculateVestedAmount(address holder) public view returns (uint256) {
        VestingSchedule memory schedule = vestingSchedules[holder];
        if (block.timestamp < schedule.startTime) return 0;
        
        // Calculate vested amount based on time elapsed
        // Implementation depends on vesting schedule details
        
        return 0;
    }
    
    // Internal transfer function
    function _transfer(address from, address to, uint256 amount) internal {
        require(from != address(0), "ERC20: transfer from the zero address");
        require(to != address(0), "ERC20: transfer to the zero address");
        require(amount <= balances[from], "ERC20: insufficient balance");
        
        balances[from] -= amount;
        balances[to] += amount;
        
        emit Transfer(from, to, amount);
    }
    
    // Phase management functions
    function addPhase(string memory name, uint256 startTime, uint256 endTime, uint256 dilution) external {
        // Only owner can add phases
        // Implementation for phase management
        phases.push(Phase(name, startTime, endTime, dilution));
    }
    
    function getCurrentPhase() public view returns (uint256) {
        // Return current phase index based on block timestamp
        return 0;
    }
}`;
            
            const blob = new Blob([contractCode], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            
            const exportFileDefaultName = `${tokenomicsData.tokenName}Token.sol`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', url);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.style.display = 'none';
            document.body.appendChild(linkElement);
            
            linkElement.click();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(linkElement);
                URL.revokeObjectURL(url);
            }, 100);
            
            alert(document.documentElement.lang === 'ca' ? 
                'Codi del Smart Contract generat correctament! Aquest √©s un model b√†sic que requereix auditoria i personalitzaci√≥ abans de la implementaci√≥.' : 
                '¬°C√≥digo del Smart Contract generado correctamente! Este es un modelo b√°sico que requiere auditor√≠a y personalizaci√≥n antes de la implementaci√≥n.');
        }
        
        // Reset data
        function resetData() {
            if (confirm(document.documentElement.lang === 'ca' ? 
                'Est√†s segur que vols esborrar totes les dades de la simulaci√≥?' : 
                '¬øEst√°s seguro de que quieres borrar todos los datos de la simulaci√≥n?')) {
                
                tokenomicsData = {
                    tokenName: "MASIA",
                    tokenSymbol: "MSA",
                    totalSupply: 1000000,
                    distributionModel: "fibonacci",
                    initialDistribution: {
                        investors: 40,
                        team: 25,
                        reserve: 20,
                        community: 15
                    },
                    stakeholders: [],
                    phases: [
                        { name: "Fase 1: Lanzamiento", months: "1-6", dilution: 5 },
                        { name: "Fase 2: Crecimiento", months: "7-18", dilution: 8 },
                        { name: "Fase 3: Escalado", months: "19-36", dilution: 13 },
                        { name: "Fase 4: Madurez", months: "37+", dilution: 21 }
                    ],
                    timelineData: null,
                    isImportMode: false,
                    importedData: null,
                    csvContent: null
                };
                
                // Reset sliders
                document.getElementById('investors-slider').value = 40;
                document.getElementById('team-slider').value = 25;
                document.getElementById('reserve-slider').value = 20;
                document.getElementById('community-slider').value = 15;
                
                document.getElementById('investors-value').textContent = '40%';
                document.getElementById('team-value').textContent = '25%';
                document.getElementById('reserve-value').textContent = '20%';
                document.getElementById('community-value').textContent = '15%';
                
                document.getElementById('token-name').value = "MASIA";
                document.getElementById('token-symbol').value = "MSA";
                document.getElementById('total-supply').value = "1000000";
                
                // Clear CSV preview
                document.getElementById('csv-preview').style.display = 'none';
                document.getElementById('value-csv-file').value = '';
                
                // Show default example
                showDefaultExample();
                
                saveData();
                
                alert(document.documentElement.lang === 'ca' ? 
                    'Dades esborrades correctament' : 
                    'Datos borrados correctamente');
            }
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('tokenomicsData', JSON.stringify(tokenomicsData));
        }
        
        // Load data from localStorage
        function loadSavedData() {
            const saved = localStorage.getItem('tokenomicsData');
            if (saved) {
                try {
                    const parsedData = JSON.parse(saved);
                    
                    tokenomicsData = {
                        tokenName: parsedData.tokenName || "MASIA",
                        tokenSymbol: parsedData.tokenSymbol || "MSA",
                        totalSupply: parsedData.totalSupply || 1000000,
                        distributionModel: parsedData.distributionModel || "fibonacci",
                        initialDistribution: parsedData.initialDistribution || {
                            investors: 40,
                            team: 25,
                            reserve: 20,
                            community: 15
                        },
                        stakeholders: parsedData.stakeholders || [],
                        phases: parsedData.phases || [
                            { name: "Fase 1: Lanzamiento", months: "1-6", dilution: 5 },
                            { name: "Fase 2: Crecimiento", months: "7-18", dilution: 8 },
                            { name: "Fase 3: Escalado", months: "19-36", dilution: 13 },
                            { name: "Fase 4: Madurez", months: "37+", dilution: 21 }
                        ],
                        timelineData: parsedData.timelineData || null,
                        isImportMode: parsedData.isImportMode || false,
                        importedData: parsedData.importedData || null,
                        csvContent: parsedData.csvContent || null
                    };
                    
                    // Restore slider values
                    document.getElementById('investors-slider').value = tokenomicsData.initialDistribution.investors;
                    document.getElementById('team-slider').value = tokenomicsData.initialDistribution.team;
                    document.getElementById('reserve-slider').value = tokenomicsData.initialDistribution.reserve;
                    document.getElementById('community-slider').value = tokenomicsData.initialDistribution.community;
                    
                    document.getElementById('investors-value').textContent = `${tokenomicsData.initialDistribution.investors}%`;
                    document.getElementById('team-value').textContent = `${tokenomicsData.initialDistribution.team}%`;
                    document.getElementById('reserve-value').textContent = `${tokenomicsData.initialDistribution.reserve}%`;
                    document.getElementById('community-value').textContent = `${tokenomicsData.initialDistribution.community}%`;
                    
                    document.getElementById('token-name').value = tokenomicsData.tokenName;
                    document.getElementById('token-symbol').value = tokenomicsData.tokenSymbol;
                    document.getElementById('total-supply').value = tokenomicsData.totalSupply.toString();
                    document.getElementById('distribution-model').value = tokenomicsData.distributionModel;
                    
                    // If CSV content exists and in import mode, show preview
                    if (tokenomicsData.csvContent && tokenomicsData.isImportMode) {
                        const previewDiv = document.getElementById('csv-preview');
                        previewDiv.style.display = 'block';
                        previewDiv.innerHTML = '<div class="csv-row csv-header"><div class="csv-cell">Datos CSV importados previamente</div></div>';
                    }
                } catch (error) {
                    console.error('Error loading saved data:', error);
                    // Reset to default if there's an error
                    tokenomicsData.stakeholders = [];
                }
            }
        }
    </script>
</body>
</html>
