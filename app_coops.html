<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Comunidades de Pr√°ctica | TeamTowers Hum√†. Sistema para gestionar el conocimiento t√°cito y expl√≠cito en tu organizaci√≥n mediante comunidades de pr√°ctica.">
    <meta name="keywords" content="Comunidades de Pr√°ctica, CoPs, conocimiento t√°cito, TeamTowers Hum√†, Vilafranca del Pened√®s, gesti√≥n del conocimiento, onboarding">
    <meta name="author" content="TeamTowers Hum√†">
    <meta name="robots" content="index, follow">
    <title>Comunidades de Pr√°ctica | TeamTowers Hum√†</title>
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Comunidades de Pr√°ctica | TeamTowers Hum√†">
    <meta property="og:description" content="Sistema para gestionar el conocimiento t√°cito y expl√≠cito en tu organizaci√≥n mediante comunidades de pr√°ctica.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://teamtowershuma.com/app_coops">
    <meta property="og:image" content="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png">
    <meta property="og:locale" content="es_ES">
    <meta property="og:locale:alternate" content="ca_ES">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Comunidades de Pr√°ctica | TeamTowers Hum√†">
    <meta name="twitter:description" content="Gesti√≥n del conocimiento t√°cito y expl√≠cito mediante comunidades de pr√°ctica">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png">
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary: #1e3a8a; /* Azul TeamTowers */
            --secondary: #4f46e5; /* Azul m√°s claro */
            --accent: #8b5cf6; /* Morado TeamTowers */
            --dark: #0f172a;
            --light: #f8fafc;
            --gold: #f59e01;
            --success: #10b981;
            --warning: #fbbf24;
            --danger: #ef4444;
            --gray: #64748b;
            --border-radius: 12px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent) 0%, #7c3aed 100%);
            --gradient-dark: linear-gradient(135deg, var(--dark) 0%, #1e293b 100%);
            --gradient-castell: linear-gradient(135deg, #8b5cf6 0%, #4f46e5 30%, #1e3a8a 60%, #0f172a 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #fff;
            overflow-x: hidden;
        }
        
        /* Language Selector */
        .language-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50px;
            padding: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 5px;
        }
        
        .lang-btn {
            padding: 8px 16px;
            border: none;
            background: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .lang-btn.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 10px rgba(30, 58, 138, 0.4);
        }
        
        /* Header */
        header {
            background: var(--gradient-dark);
            color: white;
            padding: 20px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 10;
        }
        
        .header-logo {
            height: 60px;
            margin-bottom: 15px;
            filter: drop-shadow(0 4px 10px rgba(0,0,0,0.3));
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        
        .tagline {
            font-size: 1.4rem;
            opacity: 0.9;
            margin-bottom: 15px;
            font-weight: 300;
        }
        
        .integration-badge {
            display: inline-block;
            background: rgba(139, 92, 246, 0.2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
            font-size: 0.95rem;
        }
        
        /* Hero Section with Video Background */
        .hero {
            position: relative;
            height: 100vh;
            min-height: 700px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            overflow: hidden;
        }
        
        .hero-video {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: translate(-50%, -50%);
            z-index: -1;
        }
        
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-castell);
            z-index: -1;
        }
        
        .hero-content {
            max-width: 900px;
            padding: 0 20px;
            z-index: 10;
            animation: fadeInUp 1s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .hero h1 {
            font-size: 4.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            line-height: 1.1;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e01 30%, #c08b11 70%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero p {
            font-size: 1.8rem;
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .hero-subtitle {
            font-size: 1.4rem;
            opacity: 0.95;
            margin-top: 15px;
            font-weight: 300;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        /* CTA Buttons */
        .cta-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            display: inline-block;
            padding: 16px 45px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.2rem;
            text-decoration: none;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            color: white;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(30, 58, 138, 0.4);
        }
        
        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }
        
        .btn-accent {
            background: var(--gradient-accent);
        }
        
        .btn-accent:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #0da27f 100%);
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #b91c1c 100%);
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
        }
        
        /* Main Content */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .app-container {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        
        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            height: fit-content;
            position: relative;
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient-primary);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }
        
        .panel h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            z-index: 10;
        }
        
        .panel h2::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 24px;
            background: var(--accent);
            border-radius: 4px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .input-group label::before {
            content: '‚Ä¢';
            color: var(--accent);
            font-size: 24px;
            line-height: 1;
        }
        
        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.2);
        }
        
        .input-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }
        
        .visualization-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            position: relative;
        }
        
        .visualization-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient-accent);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(135deg, var(--light) 0%, #e0e7ff 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(30, 58, 138, 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        
        .stat-item {
            text-align: center;
            min-width: 110px;
            padding: 12px 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.95rem;
            color: var(--gray);
            font-weight: 600;
        }
        
        .knowledge-area {
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .area-header {
            background: var(--gradient-primary);
            color: white;
            padding: 15px 20px;
            font-weight: 700;
            font-size: 1.4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .knowledge-list {
            padding: 20px;
        }
        
        .knowledge-item {
            background: var(--light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
            position: relative;
        }
        
        .knowledge-item.critical {
            border-left-color: var(--danger);
            background: rgba(239, 68, 68, 0.05);
        }
        
        .knowledge-item h4 {
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 1.2rem;
        }
        
        .knowledge-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .knowledge-type {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .knowledge-description {
            margin-bottom: 10px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .knowledge-description.expanded {
            -webkit-line-clamp: unset;
        }
        
        .knowledge-link {
            display: inline-block;
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
            margin-top: 5px;
        }
        
        .knowledge-link:hover {
            text-decoration: underline;
        }
        
        .knowledge-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .action-btn.delete {
            background: var(--danger);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .critical-section {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: var(--border-radius);
            padding: 25px;
            margin: 25px 0;
            border-left: 4px solid var(--danger);
        }
        
        .critical-section h3 {
            color: var(--danger);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .critical-section h3::before {
            content: '‚ö†Ô∏è';
        }
        
        .critical-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .critical-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--danger);
        }
        
        .critical-item h4 {
            color: var(--dark);
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .critical-meta {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .critical-type {
            display: inline-block;
            background: var(--danger);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .import-section {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid var(--accent);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: var(--border-radius);
        }
        
        .import-section h3 {
            color: var(--success);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .import-section h3::before {
            content: 'üì•';
            font-size: 1.4rem;
        }
        
        .import-section p {
            margin-bottom: 15px;
            color: var(--gray);
            line-height: 1.7;
            font-size: 1.05rem;
        }
        
        .export-section {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid var(--accent);
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: var(--border-radius);
        }
        
        .export-section h3 {
            color: var(--accent);
            margin-bottom: 15px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }
        
        .export-section h3::before {
            content: 'üì§';
            font-size: 1.4rem;
        }
        
        .export-section p {
            margin-bottom: 15px;
            color: var(--gray);
            line-height: 1.7;
            font-size: 1.05rem;
        }
        
        .export-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .autocomplete {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .autocomplete-items {
            position: absolute;
            border: 1px solid #e2e8f0;
            border-top: none;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            background-color: white;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.95rem;
        }
        
        .autocomplete-items div:hover {
            background-color: #f1f5f9;
            color: var(--primary);
        }
        
        .autocomplete-items div.selected {
            background-color: var(--light);
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Notification System */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .notification {
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: slideIn 0.3s, fadeOut 0.5s 2.5s forwards;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; transform: translateX(100%); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 2.3rem;
            }
            .tagline {
                font-size: 1.2rem;
            }
            .panel {
                padding: 20px;
            }
            .btn-group {
                grid-template-columns: 1fr;
            }
            .export-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .language-selector {
                top: 15px;
                right: 15px;
                padding: 3px;
            }
            .hero h1 {
                font-size: 2.5rem;
            }
            .hero p {
                font-size: 1.4rem;
            }
            .container {
                padding: 20px 15px;
            }
            .btn {
                padding: 12px 15px;
                font-size: 1rem;
            }
            .stat-value {
                font-size: 1.8rem;
            }
            .stat-label {
                font-size: 0.9rem;
            }
            .critical-list {
                grid-template-columns: 1fr;
            }
        }
        
        /* Empty states */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }
        
        .empty-state svg {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
            color: var(--accent);
            opacity: 0.7;
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--dark);
            font-weight: 700;
        }
        
        .empty-state p {
            max-width: 500px;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        /* Footer */
        footer {
            background: var(--gradient-dark);
            color: rgba(255, 255, 255, 0.85);
            padding: 70px 20px 40px;
            margin-top: 70px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 45px;
            max-width: 1300px;
            margin: 0 auto;
        }
        
        .footer-col h3 {
            color: white;
            font-size: 1.75rem;
            margin-bottom: 28px;
            position: relative;
            padding-bottom: 12px;
            font-weight: 700;
        }
        
        .footer-col h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 45px;
            height: 4px;
            background: var(--gradient-accent);
            border-radius: 2px;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 14px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.75);
            text-decoration: none;
            transition: var(--transition);
            display: block;
            padding: 6px 0;
            font-size: 1.1rem;
            font-weight: 500;
            position: relative;
            padding-left: 22px;
        }
        
        .footer-links a::before {
            content: '‚Üí';
            position: absolute;
            left: 0;
            opacity: 0;
            transform: translateX(-8px);
            transition: all 0.3s ease;
            color: var(--accent);
        }
        
        .footer-links a:hover {
            color: white;
            transform: translateX(3px);
        }
        
        .footer-links a:hover::before {
            opacity: 1;
            transform: translateX(0);
        }
        
        .copyright {
            text-align: center;
            padding-top: 50px;
            margin-top: 50px;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            font-size: 1.05rem;
            color: rgba(255, 255, 255, 0.65);
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="language-selector">
        <button class="lang-btn active" data-lang="es">ES</button>
        <button class="lang-btn" data-lang="ca">CA</button>
    </div>
    
    <!-- Notification Container -->
    <div class="notification-container" id="notification-container"></div>
    
    <!-- Header -->
    <header>
        <div class="header-content">
            <img src="https://raw.githubusercontent.com/asolache/Teamtowers/main/images/logoteamtowers.png" alt="TeamTowers Hum√†" class="header-logo">
            <h1 class="lang" data-es="Comunidades de Pr√°ctica" data-ca="Comunitats de Pr√†ctica">Comunidades de Pr√°ctica</h1>
            <p class="tagline lang" data-es="Modelos de aprendizaje basados en redes de valor" data-ca="Models d'aprenentatge basats en xarxes de valor">Modelos de aprendizaje basados en redes de valor</p>
            <div class="integration-badge lang" data-es="Parte del Sistema Integral de La Masia" data-ca="Part del Sistema Integral de La Masia">Parte del Sistema Integral de La Masia</div>
        </div>
    </header>
    
    <!-- Hero Section with Video Background -->
    <section class="hero">
        <video class="hero-video" autoplay muted loop playsinline>
            <source src="https://github.com/asolache/Teamtowers/raw/main/files/teamtowershome-1.mp4" type="video/mp4">
        </video>
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 class="lang" data-es="Comunidades de Pr√°ctica" data-ca="Comunitats de Pr√†ctica">Comunidades de Pr√°ctica</h1>
            <p class="lang" data-es="Transforma el aprendizaje organizacional con comunidades que capturan conocimiento t√°cito y desarrollan competencias cr√≠ticas de forma colaborativa y sostenible." data-ca="Transforma l'aprenentatge organitzatiu amb comunitats que capturen coneixement t√†cit i desenvolupen compet√®ncies cr√≠tiques de forma col¬∑laborativa i sostenible.">Transforma el aprendizaje organizacional con comunidades que capturan conocimiento t√°cito y desarrollan competencias cr√≠ticas de forma colaborativa y sostenible.</p>
            <p class="hero-subtitle lang" data-es="Vilafranca del Pened√®s - El coraz√≥n del Pened√®s donde nace la innovaci√≥n en gesti√≥n de personas" data-ca="Vilafranca del Pened√®s - El cor del Pened√®s on neix la innovaci√≥ en gesti√≥ de persones">Vilafranca del Pened√®s - El coraz√≥n del Pened√®s donde nace la innovaci√≥n en gesti√≥n de personas</p>
            <div class="cta-container">
                <a href="#import-section" class="btn btn-primary lang" data-es="Importar Datos" data-ca="Importar Dades">Importar Datos</a>
                <a href="#knowledge-form" class="btn btn-accent lang" data-es="Crear Conocimiento" data-ca="Crear Coneixement">Crear Conocimiento</a>
            </div>
        </div>
    </section>
    
    <!-- Main Content -->
    <div class="container">
        <div class="app-container">
            <div class="panel">
                <h2 class="lang" data-es="‚öôÔ∏è Configuraci√≥n del Proyecto" data-ca="‚öôÔ∏è Configuraci√≥ del Projecte">‚öôÔ∏è Configuraci√≥n del Proyecto</h2>
                <div class="input-group">
                    <label class="lang" data-es="Nombre del Proyecto" data-ca="Nom del Projecte">Nombre del Proyecto</label>
                    <input type="text" id="project-name" placeholder="Ej: Proyecto MASIA" value="Proyecto MASIA">
                </div>
                
                <div class="import-section" id="import-section">
                    <h3 class="lang" data-es="Importar Datos de Value Accounting" data-ca="Importar Dades de Value Accounting">Importar Datos de Value Accounting</h3>
                    <p class="lang" data-es="Importa los datos de tu proyecto desde la <a href='https://teamtowershuma.com/app_comptabilitat' target='_blank' style='color: var(--primary); font-weight: 600;'>App de Contabilidad de Valor</a> para generar autom√°ticamente tu base de conocimiento." data-ca="Importa les dades del teu projecte des de l'<a href='https://teamtowershuma.com/app_comptabilitat' target='_blank' style='color: var(--primary); font-weight: 600;'>App de Comptabilitat de Valor</a> per generar autom√†ticament la teva base de coneixement.">Importa los datos de tu proyecto desde la <a href="https://teamtowershuma.com/app_comptabilitat" target="_blank" style="color: var(--primary); font-weight: 600;">App de Contabilidad de Valor</a> para generar autom√°ticamente tu base de conocimiento.</p>
                    
                    <div class="input-group">
                        <label class="lang" data-es="Archivo JSON de Value Accounting" data-ca="Fitxer JSON de Value Accounting">Archivo JSON de Value Accounting</label>
                        <input type="file" id="import-json-file" accept=".json">
                    </div>
                    <div class="btn-group">
                        <button id="import-json" class="btn btn-success">
                            <span>üì•</span> <span class="lang" data-es="Importar JSON" data-ca="Importar JSON">Importar JSON</span>
                        </button>
                    </div>
                </div>
                
                <div class="panel" style="margin-top: 25px;" id="knowledge-form">
                    <h2 class="lang" data-es="‚ûï A√±adir Conocimiento" data-ca="‚ûï Afegir Coneixement">‚ûï A√±adir Conocimiento</h2>
                    <div class="input-group">
                        <label class="lang" data-es="Rol:" data-ca="Rol:">Rol:</label>
                        <div class="autocomplete">
                            <input type="text" id="role-name" placeholder="Escribe un rol...">
                            <div id="role-list" class="autocomplete-items"></div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="lang" data-es="Entregable:" data-ca="Entregable:">Entregable:</label>
                        <div class="autocomplete">
                            <input type="text" id="deliverable-name" placeholder="Escribe un entregable...">
                            <div id="deliverable-list" class="autocomplete-items"></div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="lang" data-es="√Årea de Conocimiento:" data-ca="√Ärea de Coneixement:">√Årea de Conocimiento:</label>
                        <select id="knowledge-area">
                            <option value="marketing" class="lang" data-es="Marketing y Ventas" data-ca="Marketing i Vendes">Marketing y Ventas</option>
                            <option value="tecnologia" class="lang" data-es="Tecnolog√≠a / Innovaci√≥n" data-ca="Tecnologia / Innovaci√≥">Tecnolog√≠a / Innovaci√≥n</option>
                            <option value="rrhh" class="lang" data-es="Recursos Humanos" data-ca="Recursos Humans">Recursos Humanos</option>
                            <option value="finanzas" class="lang" data-es="Finanzas y Contabilidad" data-ca="Finances i Comptabilitat">Finanzas y Contabilidad</option>
                            <option value="operaciones" class="lang" data-es="Operaciones y Log√≠stica" data-ca="Operacions i Log√≠stica">Operaciones y Log√≠stica</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="lang" data-es="Tipo de Conocimiento:" data-ca="Tipus de Coneixement:">Tipo de Conocimiento:</label>
                        <select id="knowledge-type">
                            <option value="procedimiento" class="lang" data-es="Procedimiento / Buena pr√°ctica" data-ca="Procediment / Bona pr√†ctica">Procedimiento / Buena pr√°ctica</option>
                            <option value="herramienta" class="lang" data-es="Herramienta / Recurso" data-ca="Eina / Recurs">Herramienta / Recurso</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="lang" data-es="Descripci√≥n:" data-ca="Descripci√≥:">Descripci√≥n:</label>
                        <textarea id="description" placeholder="Describe el conocimiento en detalle"></textarea>
                    </div>
                    <div class="input-group">
                        <label class="lang" data-es="Enlace (opcional):" data-ca="Enlla√ß (opcional):">Enlace (opcional):</label>
                        <input type="url" id="link" placeholder="https://ejemplo.com/recurso">
                    </div>
                    <div class="btn-group" style="margin-top: 15px; grid-template-columns: 1fr;">
                        <button id="add-knowledge" class="btn btn-primary">
                            <span>‚ú®</span> <span class="lang" data-es="Registrar Conocimiento" data-ca="Registrar Coneixement">Registrar Conocimiento</span>
                        </button>
                    </div>
                </div>
                
                <div class="panel" style="margin-top: 25px;">
                    <h2 class="lang" data-es="üíæ Exportar Datos" data-ca="üíæ Exportar Dades">üíæ Exportar Datos</h2>
                    <div class="export-buttons">
                        <button id="export-csv" class="btn btn-success">
                            <span>üìà</span> <span class="lang" data-es="Exportar CSV" data-ca="Exportar CSV">Exportar CSV</span>
                        </button>
                        <button id="reset-data" class="btn btn-danger">
                            <span>üóëÔ∏è</span> <span class="lang" data-es="Limpiar Datos" data-ca="Netejar Dades">Limpiar Datos</span>
                        </button>
                    </div>
                </div>
                
                <div class="export-section">
                    <h3 class="lang" data-es="Exportar para Gesti√≥n del Conocimiento" data-ca="Exportar per a Gesti√≥ del Coneixement">Exportar para Gesti√≥n del Conocimiento</h3>
                    <p class="lang" data-es="Exporta tu base de conocimiento como CSV para an√°lisis posterior o integraci√≥n con otros sistemas de gesti√≥n del conocimiento." data-ca="Exporta la teva base de coneixement com a CSV per a an√†lisi posterior o integraci√≥ amb altres sistemes de gesti√≥ del coneixement.">Exporta tu base de conocimiento como CSV para an√°lisis posterior o integraci√≥n con otros sistemas de gesti√≥n del conocimiento.</p>
                </div>
            </div>
            
            <div class="visualization-container">
                <h2>üìä <span class="lang" data-es="Estad√≠sticas y An√°lisis" data-ca="Estad√≠stiques i An√†lisi">Estad√≠sticas y An√°lisis</span></h2>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" id="total-knowledge">0</div>
                        <div class="stat-label lang" data-es="Conocimientos" data-ca="Coneixements">Conocimientos</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="active-roles">0</div>
                        <div class="stat-label lang" data-es="Roles Activos" data-ca="Rols Actius">Roles Activos</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="critical-topics">0</div>
                        <div class="stat-label lang" data-es="Temas Cr√≠ticos" data-ca="Temes Cr√≠tics">Temas Cr√≠ticos</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="knowledge-areas">0</div>
                        <div class="stat-label lang" data-es="√Åreas" data-ca="√Ärees">√Åreas</div>
                    </div>
                </div>
                
                <div class="critical-section">
                    <h3 class="lang" data-es="Temas Cr√≠ticos Detectados" data-ca="Temes Cr√≠tics Detectats">Temas Cr√≠ticos Detectados</h3>
                    <p class="lang" data-es="√çndice de Temas Cr√≠ticos por Rol: generado autom√°ticamente a partir de las transacciones del mapa de valor y el tiempo promedio estimado de cada entregable. Los temas marcados como cr√≠ticos requieren atenci√≥n prioritaria." data-ca="√çndex de Temes Cr√≠tics per Rol: generat autom√†ticament a partir de les transaccions del mapa de valor i el temps promig estimat de cada entregable. Els temes marcats com a cr√≠tics requereixen atenci√≥ priorit√†ria.">√çndice de Temas Cr√≠ticos por Rol: generado autom√°ticamente a partir de las transacciones del mapa de valor y el tiempo promedio estimado de cada entregable. Los temas marcados como cr√≠ticos requieren atenci√≥n prioritaria.</p>
                    
                    <div id="critical-list" class="critical-list">
                        <!-- Critical topics will be inserted here dynamically -->
                        <div class="empty-state">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                            <h3 class="lang" data-es="No hay temas cr√≠ticos detectados" data-ca="No hi ha temes cr√≠tics detectats">No hay temas cr√≠ticos detectados</h3>
                            <p class="lang" data-es="Importa datos de Value Accounting para identificar brechas de conocimiento" data-ca="Importa dades de Value Accounting per identificar breus de coneixement">Importa datos de Value Accounting para identificar brechas de conocimiento</p>
                        </div>
                    </div>
                </div>
                
                <h2 style="margin: 25px 0 15px; color: var(--primary);" class="lang" data-es="üìö Repositorio de Conocimiento" data-ca="üìö Repositori de Coneixement">üìö Repositorio de Conocimiento</h2>
                
                <div id="knowledge-repository">
                    <!-- Knowledge items will be inserted here dynamically -->
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                        <h3 class="lang" data-es="No hay conocimientos registrados a√∫n" data-ca="No hi ha coneixements registrats encara">No hay conocimientos registrados a√∫n</h3>
                        <p class="lang" data-es="Importa datos de Value Accounting o crea manualmente tu primer conocimiento" data-ca="Importa dades de Value Accounting o crea manualment el teu primer coneixement">Importa datos de Value Accounting o crea manualmente tu primer conocimiento</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <h3 class="lang" data-es="TeamTowers Hum√†" data-ca="TeamTowers Hum√†">TeamTowers Hum√†</h3>
                <p class="lang" data-es="De las torres humanas a las organizaciones humanas. Consultor√≠a estrat√©gica de RRHH con enfoque humanista desde Vilafranca del Pened√®s." data-ca="De les torres humanes a les organitzacions humanes. Consultoria estrat√®gica de RRHH amb enfocament humanista des de Vilafranca del Pened√®s.">De las torres humanas a las organizaciones humanas. Consultor√≠a estrat√©gica de RRHH con enfoque humanista desde Vilafranca del Pened√®s.</p>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Servicios" data-ca="Serveis">Servicios</h3>
                <ul class="footer-links">
                    <li><a href="https://teamtowershuma.com/" class="lang" data-es="TeamTowers" data-ca="TeamTowers">TeamTowers</a></li>
                    <li><a href="https://teamtowershuma.com/valor" class="lang" data-es="Value Network Analysis" data-ca="Value Network Analysis">Value Network Analysis</a></li>
                    <li><a href="https://teamtowershuma.com/coops" class="lang" data-es="Comunidades de Pr√°ctica" data-ca="Comunitats de Pr√†ctica">Comunidades de Pr√°ctica</a></li>
                    <li><a href="https://teamtowershuma.com/rrhh" class="lang" data-es="Business Partner RRHH" data-ca="Business Partner RRHH">Business Partner RRHH</a></li>
                    <li><a href="https://teamtowershuma.com/masia" class="lang" data-es="La Masia" data-ca="La Masia">La Masia</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Apps del Ecosistema" data-ca="Apps de l'Ecosistema">Apps del Ecosistema</h3>
                <ul class="footer-links">
                    <li><a href="https://teamtowershuma.com/app" class="lang" data-es="App VNA" data-ca="App VNA">App VNA</a></li>
                    <li><a href="https://teamtowershuma.com/app_comptabilitat" class="lang" data-es="App Contabilidad de Valor" data-ca="App Comptabilitat de Valor">App Contabilidad de Valor</a></li>
                    <li><a href="https://teamtowershuma.com/app_coops" class="lang" data-es="App Comunidades de Pr√°ctica" data-ca="App Comunitats de Pr√†ctica">App Comunidades de Pr√°ctica</a></li>
                    <li><a href="https://teamtowershuma.com/tokenomics" class="lang" data-es="App Tokenomics" data-ca="App Tokenomics">App Tokenomics</a></li>
                    <li><a href="https://cursovna.netlify.app/" target="_blank" class="lang" data-es="Curso de VNA" data-ca="Curs de VNA">Curso de VNA</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3 class="lang" data-es="Contacto" data-ca="Contacte">Contacto</h3>
                <ul class="footer-links">
                    <li>Vilafranca del Pened√®s, Barcelona</li>
                    <li>+34 629 86 77 15</li>
                    <li>
                        <a href="mailto:asolache@mac.com" style="color: var(--accent); font-weight: 600;">
                            <span class="lang" data-es="Enviar mensaje" data-ca="Enviar missatge">Enviar mensaje</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/alvarosolache" target="_blank" style="color: var(--accent); font-weight: 600;">LinkedIn</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p class="lang" data-es="¬© 2026 TeamTowers Hum√†. Todos los derechos reservados. Sistema de Comunidades de Pr√°ctica con preparaci√≥n para gesti√≥n del conocimiento y tokenizaci√≥n." data-ca="¬© 2026 TeamTowers Hum√†. Tots els drets reservats. Sistema de Comunitats de Pr√†ctica amb preparaci√≥ per a gesti√≥ del coneixement i tokenitzaci√≥.">¬© 2026 TeamTowers Hum√†. Todos los derechos reservados. Sistema de Comunidades de Pr√°ctica con preparaci√≥n para gesti√≥n del conocimiento y tokenizaci√≥n.</p>
        </div>
    </footer>
    
    <script>
        // ========== W3C COMPLIANT COMMUNITIES OF PRACTICE APP ==========
        // Data structure that can be easily migrated to a database
        let copData = {
            projectName: "Proyecto MASIA",
            importedData: null, // Will store the imported Value Accounting data
            knowledgeBase: [] // Each knowledge entry: { id, role, deliverable, area, type, description, link, timestamp }
        };
        
        // Notification system
        function showNotification(message, type = 'info', duration = 3000) {
            const container = document.getElementById('notification-container');
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `<span>${message}</span>`;
            
            // Add to container
            container.appendChild(notification);
            
            // Remove after duration
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.5s forwards';
                setTimeout(() => {
                    if (notification.parentNode) {
                        container.removeChild(notification);
                    }
                }, 500);
            }, duration);
            
            return notification;
        }
        
        // Import data from JSON
        function importJSON() {
            const fileInput = document.getElementById('import-json-file');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('‚ö†Ô∏è Selecciona un archivo JSON primero', 'warning');
                return;
            }
            
            // Show loading state
            const importBtn = document.getElementById('import-json');
            const originalHTML = importBtn.innerHTML;
            importBtn.innerHTML = '<span style="display:inline-block;width:16px;height:16px;border:2px solid white;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;margin-right:8px;"></span> Importando...';
            importBtn.disabled = true;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate structure
                    if (!importedData.projectName || !importedData.valueUnit || !Array.isArray(importedData.roles) || !Array.isArray(importedData.deliverables)) {
                        throw new Error('El archivo JSON no tiene la estructura correcta de Value Accounting');
                    }
                    
                    // Import data
                    copData.importedData = importedData;
                    copData.projectName = importedData.projectName;
                    
                    // Update project name field
                    document.getElementById('project-name').value = copData.projectName;
                    
                    // Save and update
                    saveData();
                    updateVisualizations();
                    
                    showNotification(`‚úÖ Datos importados correctamente: ${importedData.deliverables.length} entregables, ${importedData.roles.length} roles`, 'success');
                } catch (error) {
                    console.error('Error importing JSON:', error);
                    showNotification(`‚ùå Error al importar: ${error.message}`, 'error');
                } finally {
                    // Restore button
                    importBtn.innerHTML = originalHTML;
                    importBtn.disabled = false;
                }
            };
            
            reader.onerror = function() {
                importBtn.innerHTML = originalHTML;
                importBtn.disabled = false;
                showNotification('‚ùå Error al leer el archivo', 'error');
            };
            
            reader.readAsText(file);
        }
        
        // Add knowledge entry
        function addKnowledge() {
            const roleName = document.getElementById('role-name').value.trim();
            const deliverableName = document.getElementById('deliverable-name').value.trim();
            const knowledgeArea = document.getElementById('knowledge-area').value;
            const knowledgeType = document.getElementById('knowledge-type').value;
            const description = document.getElementById('description').value.trim();
            const link = document.getElementById('link').value.trim();
            
            // Validate inputs
            if (!roleName) {
                showNotification('‚ö†Ô∏è El campo "Rol" es obligatorio', 'warning');
                document.getElementById('role-name').focus();
                return;
            }
            
            if (!deliverableName) {
                showNotification('‚ö†Ô∏è El campo "Entregable" es obligatorio', 'warning');
                document.getElementById('deliverable-name').focus();
                return;
            }
            
            if (!description) {
                showNotification('‚ö†Ô∏è El campo "Descripci√≥n" es obligatorio', 'warning');
                document.getElementById('description').focus();
                return;
            }
            
            // Create knowledge entry
            const knowledgeEntry = {
                id: `knowledge-${Date.now()}`,
                role: roleName,
                deliverable: deliverableName,
                area: knowledgeArea,
                type: knowledgeType,
                description: description,
                link: link,
                timestamp: new Date().toISOString()
            };
            
            // Add to knowledge base
            copData.knowledgeBase.push(knowledgeEntry);
            
            // Save and update
            saveData();
            updateVisualizations();
            
            // Clear form
            document.getElementById('role-name').value = '';
            document.getElementById('deliverable-name').value = '';
            document.getElementById('description').value = '';
            document.getElementById('link').value = '';
            
            // Show success
            showNotification(`‚úÖ Conocimiento registrado: "${deliverableName}" para el rol ${roleName}`, 'success');
        }
        
        // Delete knowledge entry
        function deleteKnowledge(id) {
            if (!confirm('¬øEst√°s seguro de que quieres eliminar este conocimiento?')) {
                return;
            }
            
            // Find knowledge index
            const knowledgeIndex = copData.knowledgeBase.findIndex(k => k.id === id);
            if (knowledgeIndex === -1) return;
            
            const knowledge = copData.knowledgeBase[knowledgeIndex];
            
            // Remove from knowledge base
            copData.knowledgeBase.splice(knowledgeIndex, 1);
            
            // Save and update
            saveData();
            updateVisualizations();
            
            showNotification(`üóëÔ∏è Conocimiento eliminado: "${knowledge.deliverable}"`, 'info');
        }
        
        // Update visualizations
        function updateVisualizations() {
            // Update stats
            updateStats();
            
            // Update critical topics
            updateCriticalTopics();
            
            // Update knowledge repository
            updateKnowledgeRepository();
            
            // Update autocomplete suggestions
            updateAutocompleteSuggestions();
        }
        
        // Update stats
        function updateStats() {
            // Total knowledge entries
            document.getElementById('total-knowledge').textContent = copData.knowledgeBase.length;
            
            // Active roles (roles with at least 1 knowledge entry)
            const activeRoles = [...new Set(copData.knowledgeBase.map(k => k.role))];
            document.getElementById('active-roles').textContent = activeRoles.length;
            
            // Critical topics (deliverables without knowledge)
            const criticalTopics = getCriticalTopics();
            document.getElementById('critical-topics').textContent = criticalTopics.length;
            
            // Knowledge areas
            const knowledgeAreas = [...new Set(copData.knowledgeBase.map(k => k.area))];
            document.getElementById('knowledge-areas').textContent = knowledgeAreas.length;
        }
        
        // Get critical topics (deliverables without associated knowledge)
        function getCriticalTopics() {
            if (!copData.importedData || !copData.importedData.deliverables) return [];
            
            // Get all deliverables from imported data
            const allDeliverables = copData.importedData.deliverables;
            
            // Get deliverables with knowledge
            const deliverablesWithKnowledge = copData.knowledgeBase.map(k => k.deliverable);
            
            // Find deliverables without knowledge
            const criticalTopics = allDeliverables.filter(d => 
                !deliverablesWithKnowledge.includes(d.deliverable)
            );
            
            // Remove duplicates and sort by value (descending)
            const uniqueCriticalTopics = [...new Map(criticalTopics.map(d => [d.deliverable, d])).values()]
                .sort((a, b) => b.value - a.value);
            
            return uniqueCriticalTopics;
        }
        
        // Update critical topics section
        function updateCriticalTopics() {
            const criticalList = document.getElementById('critical-list');
            const criticalTopics = getCriticalTopics();
            
            if (criticalTopics.length === 0) {
                criticalList.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        <h3 class="lang" data-es="No hay temas cr√≠ticos detectados" data-ca="No hi ha temes cr√≠tics detectats">No hay temas cr√≠ticos detectados</h3>
                        <p class="lang" data-es="Todos los entregables tienen conocimiento asociado" data-ca="Tots els entregables tenen coneixement associat">Todos los entregables tienen conocimiento asociado</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            criticalTopics.forEach(topic => {
                html += `
                    <div class="critical-item">
                        <h4>${topic.deliverable}</h4>
                        <div class="critical-meta">
                            <span>Rol: ${topic.role}</span>
                            <span class="critical-type">${topic.transactionType === 'tangible' ? 'Tangible' : 'Intangible'}</span>
                        </div>
                        <p>Valor: ${topic.value} ${copData.importedData.valueUnit}</p>
                    </div>
                `;
            });
            
            criticalList.innerHTML = html;
        }
        
        // Update knowledge repository
        function updateKnowledgeRepository() {
            const repository = document.getElementById('knowledge-repository');
            
            if (copData.knowledgeBase.length === 0) {
                repository.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                        <h3 class="lang" data-es="No hay conocimientos registrados a√∫n" data-ca="No hi ha coneixements registrats encara">No hay conocimientos registrados a√∫n</h3>
                        <p class="lang" data-es="Importa datos de Value Accounting o crea manualmente tu primer conocimiento" data-ca="Importa dades de Value Accounting o crea manualment el teu primer coneixement">Importa datos de Value Accounting o crea manualmente tu primer conocimiento</p>
                    </div>
                `;
                return;
            }
            
            // Group knowledge by area
            const knowledgeByArea = {};
            copData.knowledgeBase.forEach(knowledge => {
                if (!knowledgeByArea[knowledge.area]) {
                    knowledgeByArea[knowledge.area] = [];
                }
                knowledgeByArea[knowledge.area].push(knowledge);
            });
            
            // Define area names for display
            const areaNames = {
                marketing: 'Marketing y Ventas',
                tecnologia: 'Tecnolog√≠a / Innovaci√≥n',
                rrhh: 'Recursos Humanos',
                finanzas: 'Finanzas y Contabilidad',
                operaciones: 'Operaciones y Log√≠stica'
            };
            
            // Generate HTML for each area
            let html = '';
            Object.entries(knowledgeByArea).sort().forEach(([area, knowledgeItems]) => {
                html += `
                    <div class="knowledge-area">
                        <div class="area-header">
                            <span>${areaNames[area] || area}</span>
                            <span>${knowledgeItems.length} conocimientos</span>
                        </div>
                        <div class="knowledge-list">
                `;
                
                // Sort knowledge items by deliverable name
                knowledgeItems.sort((a, b) => a.deliverable.localeCompare(b.deliverable));
                
                knowledgeItems.forEach(knowledge => {
                    // Check if this knowledge is for a critical topic
                    const isCritical = copData.importedData && 
                        copData.importedData.deliverables.some(d => 
                            d.deliverable === knowledge.deliverable && 
                            !copData.knowledgeBase.some(k => k.deliverable === d.deliverable && k.id !== knowledge.id)
                        );
                    
                    html += `
                        <div class="knowledge-item ${isCritical ? 'critical' : ''}">
                            <h4>${knowledge.deliverable}</h4>
                            <div class="knowledge-meta">
                                <span>Rol: ${knowledge.role}</span>
                                <span class="knowledge-type">${knowledge.type === 'procedimiento' ? 'Procedimiento' : 'Herramienta'}</span>
                            </div>
                            <p class="knowledge-description">${knowledge.description}</p>
                            ${knowledge.link ? `<a href="${knowledge.link}" target="_blank" rel="noopener" class="knowledge-link">Ver recurso ‚Üí</a>` : ''}
                            <div class="knowledge-actions">
                                <button class="action-btn delete" data-id="${knowledge.id}">
                                    <span>üóëÔ∏è</span> <span class="lang" data-es="Eliminar" data-ca="Eliminar">Eliminar</span>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            repository.innerHTML = html;
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.action-btn.delete').forEach(button => {
                button.addEventListener('click', function() {
                    deleteKnowledge(this.getAttribute('data-id'));
                });
            });
        }
        
        // Update autocomplete suggestions
        function updateAutocompleteSuggestions() {
            // Update role suggestions
            const roleInput = document.getElementById('role-name');
            const roleList = document.getElementById('role-list');
            
            roleInput.addEventListener('input', function(e) {
                const value = this.value.trim();
                roleList.innerHTML = '';
                
                if (value === '') return;
                
                // Get suggestions from imported data or existing knowledge
                let suggestions = [];
                
                if (copData.importedData && copData.importedData.roles) {
                    suggestions = [...copData.importedData.roles];
                }
                
                // Add roles from existing knowledge
                const existingRoles = [...new Set(copData.knowledgeBase.map(k => k.role))];
                suggestions = [...new Set([...suggestions, ...existingRoles])];
                
                // Filter case-insensitive
                const matches = suggestions.filter(role => 
                    role.toLowerCase().includes(value.toLowerCase())
                ).slice(0, 10); // Limit to 10 results
                
                // Display matches
                matches.forEach(role => {
                    const div = document.createElement('div');
                    div.textContent = role;
                    div.addEventListener('click', function() {
                        roleInput.value = role;
                        roleList.innerHTML = '';
                        roleInput.focus();
                        
                        // Update deliverable suggestions when role is selected
                        updateDeliverableSuggestions(role);
                    });
                    roleList.appendChild(div);
                });
                
                // Add "Create new" option if no matches
                if (matches.length === 0) {
                    const div = document.createElement('div');
                    div.innerHTML = `‚ûï <strong>Crear:</strong> "${value}"`;
                    div.style.fontStyle = 'italic';
                    div.addEventListener('click', function() {
                        roleInput.value = value;
                        roleList.innerHTML = '';
                        roleInput.focus();
                    });
                    roleList.appendChild(div);
                }
            });
            
            // Update deliverable suggestions when role changes
            function updateDeliverableSuggestions(role) {
                const deliverableInput = document.getElementById('deliverable-name');
                const deliverableList = document.getElementById('deliverable-list');
                
                deliverableInput.addEventListener('input', function(e) {
                    const value = this.value.trim();
                    deliverableList.innerHTML = '';
                    
                    if (value === '') return;
                    
                    // Get suggestions from imported data for this role
                    let suggestions = [];
                    
                    if (copData.importedData && copData.importedData.deliverables) {
                        suggestions = copData.importedData.deliverables
                            .filter(d => d.role.toLowerCase() === role.toLowerCase())
                            .map(d => d.deliverable);
                    }
                    
                    // Add deliverables from existing knowledge for this role
                    const existingDeliverables = copData.knowledgeBase
                        .filter(k => k.role.toLowerCase() === role.toLowerCase())
                        .map(k => k.deliverable);
                    
                    suggestions = [...new Set([...suggestions, ...existingDeliverables])];
                    
                    // Filter case-insensitive
                    const matches = suggestions.filter(deliverable => 
                        deliverable.toLowerCase().includes(value.toLowerCase())
                    ).slice(0, 10); // Limit to 10 results
                    
                    // Display matches
                    matches.forEach(deliverable => {
                        const div = document.createElement('div');
                        div.textContent = deliverable;
                        div.addEventListener('click', function() {
                            deliverableInput.value = deliverable;
                            deliverableList.innerHTML = '';
                            deliverableInput.focus();
                        });
                        deliverableList.appendChild(div);
                    });
                    
                    // Add "Create new" option if no matches
                    if (matches.length === 0) {
                        const div = document.createElement('div');
                        div.innerHTML = `‚ûï <strong>Crear:</strong> "${value}"`;
                        div.style.fontStyle = 'italic';
                        div.addEventListener('click', function() {
                            deliverableInput.value = value;
                            deliverableList.innerHTML = '';
                            deliverableInput.focus();
                        });
                        deliverableList.appendChild(div);
                    }
                });
            }
            
            // Initialize deliverable suggestions when role is selected
            roleInput.addEventListener('focus', function() {
                const selectedRole = this.value.trim();
                if (selectedRole) {
                    updateDeliverableSuggestions(selectedRole);
                }
            });
        }
        
        // Export CSV
        function exportCSV() {
            if (copData.knowledgeBase.length === 0) {
                showNotification('‚ö†Ô∏è No hay conocimientos para exportar. Registra conocimientos primero.', 'warning');
                return;
            }
            
            try {
                // CSV headers
                let csv = '√Årea,Entregable,Rol,Tipo de conocimiento,Descripci√≥n,Enlace\n';
                
                // Sort knowledge by area and then by critical status
                const sortedKnowledge = [...copData.knowledgeBase].sort((a, b) => {
                    // First sort by area
                    if (a.area !== b.area) {
                        return a.area.localeCompare(b.area);
                    }
                    
                    // Then sort by critical status (critical first)
                    const aIsCritical = getCriticalTopics().some(t => t.deliverable === a.deliverable);
                    const bIsCritical = getCriticalTopics().some(t => t.deliverable === b.deliverable);
                    
                    if (aIsCritical && !bIsCritical) return -1;
                    if (!aIsCritical && bIsCritical) return 1;
                    
                    // Finally sort by deliverable name
                    return a.deliverable.localeCompare(b.deliverable);
                });
                
                // Data rows
                sortedKnowledge.forEach(knowledge => {
                    // Define area names for display
                    const areaNames = {
                        marketing: 'Marketing y Ventas',
                        tecnologia: 'Tecnolog√≠a / Innovaci√≥n',
                        rrhh: 'Recursos Humanos',
                        finanzas: 'Finanzas y Contabilidad',
                        operaciones: 'Operaciones y Log√≠stica'
                    };
                    
                    // Define type names for display
                    const typeNames = {
                        procedimiento: 'Procedimiento / Buena pr√°ctica',
                        herramienta: 'Herramienta / Recurso'
                    };
                    
                    csv += `"${areaNames[knowledge.area] || knowledge.area}","${knowledge.deliverable}","${knowledge.role}","${typeNames[knowledge.type] || knowledge.type}","${knowledge.description.replace(/"/g, '""')}","${knowledge.link}"\n`;
                });
                
                // Create blob and download
                const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
                const url = URL.createObjectURL(blob);
                
                const exportFileDefaultName = `comunidades-practica-${copData.projectName.replace(/\s+/g, '-').toLowerCase()}-${new Date().toISOString().slice(0,10)}.csv`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', url);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.style.display = 'none';
                document.body.appendChild(linkElement);
                
                linkElement.click();
                
                // Clean up
                setTimeout(() => {
                    document.body.removeChild(linkElement);
                    URL.revokeObjectURL(url);
                }, 100);
                
                showNotification(`‚úÖ Exportado correctamente: ${copData.knowledgeBase.length} conocimientos`, 'success');
            } catch (error) {
                console.error('Error exporting CSV:', error);
                showNotification(`‚ùå Error al exportar CSV: ${error.message}`, 'error');
            }
        }
        
        // Reset data
        function resetData() {
            if (confirm('¬øEst√°s seguro de que quieres borrar todos los datos del proyecto? Esta acci√≥n no se puede deshacer.')) {
                resetDataWithoutConfirmation();
                showNotification('üóëÔ∏è Todos los datos han sido eliminados', 'info');
            }
        }
        
        // Reset without confirmation (for tests)
        function resetDataWithoutConfirmation() {
            copData = {
                projectName: "Proyecto MASIA",
                importedData: null,
                knowledgeBase: []
            };
            
            // Clear form fields
            document.getElementById('project-name').value = "Proyecto MASIA";
            document.getElementById('role-name').value = '';
            document.getElementById('deliverable-name').value = '';
            document.getElementById('description').value = '';
            document.getElementById('link').value = '';
            
            // Save and update
            saveData();
            updateVisualizations();
        }
        
        // Save data to localStorage
        function saveData() {
            try {
                localStorage.setItem('copData', JSON.stringify(copData));
            } catch (error) {
                console.error('Error saving ', error);
                showNotification('‚ö†Ô∏è No se pudieron guardar los datos. El almacenamiento local puede estar deshabilitado.', 'warning');
            }
        }
        
        // Load data from localStorage
        function loadData() {
            try {
                const saved = localStorage.getItem('copData');
                if (saved) {
                    const parsedData = JSON.parse(saved);
                    
                    // Validate structure before loading
                    if (parsedData.projectName && Array.isArray(parsedData.knowledgeBase)) {
                        copData = parsedData;
                        
                        // Restore form fields
                        document.getElementById('project-name').value = copData.projectName;
                        
                        // Show notification if data was loaded
                        if (copData.knowledgeBase.length > 0 || copData.importedData) {
                            showNotification(`‚úÖ Datos cargados: ${copData.knowledgeBase.length} conocimientos`, 'info');
                        }
                    }
                }
            } catch (error) {
                console.error('Error loading data:', error);
                showNotification('‚ö†Ô∏è Error al cargar los datos guardados', 'warning');
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Form elements
            document.getElementById('import-json').addEventListener('click', importJSON);
            document.getElementById('add-knowledge').addEventListener('click', addKnowledge);
            document.getElementById('export-csv').addEventListener('click', exportCSV);
            document.getElementById('reset-data').addEventListener('click', resetData);
            
            // Project name change
            document.getElementById('project-name').addEventListener('change', function() {
                copData.projectName = this.value || "Proyecto MASIA";
                saveData();
            });
        }
        
        // Setup language selector
        function setupLanguageSelector() {
            const langButtons = document.querySelectorAll('.lang-btn');
            const translatableElements = document.querySelectorAll('[data-es], [data-ca]');
            
            // Set initial language based on browser
            const userLang = navigator.language.startsWith('ca') ? 'ca' : 'es';
            setActiveLanguage(userLang);
            
            // Event listeners for language buttons
            langButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const selectedLang = this.getAttribute('data-lang');
                    setActiveLanguage(selectedLang);
                    
                    // Update active button
                    langButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    showNotification(selectedLang === 'ca' ? '‚úÖ Idioma canviat a Catal√†' : '‚úÖ Idioma cambiado a Espa√±ol', 'info');
                });
            });
            
            function setActiveLanguage(lang) {
                translatableElements.forEach(element => {
                    if (element.hasAttribute(`data-${lang}`)) {
                        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                            element.placeholder = element.getAttribute(`data-${lang}`);
                        } else {
                            element.textContent = element.getAttribute(`data-${lang}`);
                        }
                    }
                });
                
                // Hide/show language-specific elements
                document.querySelectorAll('[lang="es"]').forEach(el => {
                    el.style.display = lang === 'es' ? 'block' : 'none';
                });
                document.querySelectorAll('[lang="ca"]').forEach(el => {
                    el.style.display = lang === 'ca' ? 'block' : 'none';
                });
                
                document.documentElement.setAttribute('lang', lang);
            }
        }
        
        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Setup language
            setupLanguageSelector();
            
            // Load saved data
            loadData();
            
            // Setup event listeners
            setupEventListeners();
            
            // Setup autocomplete
            updateAutocompleteSuggestions();
            
            // Update visualizations
            updateVisualizations();
            
            // Show welcome notification
            setTimeout(() => {
                showNotification('‚ú® ¬°Bienvenido a Comunidades de Pr√°ctica! Importa datos de Value Accounting o crea conocimiento manualmente.', 'success', 5000);
            }, 1000);
            
            // Show tip after 3 seconds
            setTimeout(() => {
                if (!copData.importedData) {
                    showNotification('üí° Consejo: Importa datos de Value Accounting para identificar autom√°ticamente temas cr√≠ticos y brechas de conocimiento', 'info', 8000);
                }
            }, 3000);
        });
    </script>
</body>
</html>

